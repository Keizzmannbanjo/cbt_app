(window.webpackJsonp=window.webpackJsonp||[]).push([["2rZ3"],{"Az/T":function(e,t,n){"use strict";var o=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.DiscussionList=void 0;var a=o(n("pVnL")),r=v(n("q1tI")),i=n("/MKj"),s=n("mR6N"),l=o(n("wa3X")),c=n("yhei"),d=o(n("Pwnf")),p=n("Vxy9"),u=o(n("gE8/")),f=n("JimW"),m=n("Pk2J"),g=o(n("y6Wz")),y=n("AE4M"),h=n("i4Cj"),b=v(n("TqM9")),w=o(n("cfQQ")),E=n("DDFQ");function C(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(C=function(e){return e?n:t})(e)}function v(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=C(t);if(n&&n.has(e))return n.get(e);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var i=a?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(o,r,i):o[r]=e[r]}return o.default=e,n&&n.set(e,o),o}class S extends r.Component{constructor(...e){super(...e),this.getPostsToShow=()=>{const{postKeys:e,newPostKey:t,tab:n,contentKind:o,profile:a}=this.props,r=a&&a.get("isModerator");return"clarifications"===n&&"Article"===o&&!r?e.filter((e=>e===t)):e},this.isCompactView=()=>"compact"===this.props.discussionContext.viewMode,this.isMaximized=()=>"maximized"===this.props.discussionContext.view,this.maybeRenderListHeader=e=>{const{tab:t,contentKind:n}=this.props;return e.length||"Video"!==n||"clarifications"!==t?null:r.createElement(p.LabelLarge,{style:b.clarificationsListHeader},h.miscStrings.clarificationListSuggested)},this.renderContent=e=>{const{fetchingPosts:t,newPostKey:n,resetNewPostKeyInfo:o,tab:a,topicSlug:i,discussionContext:d,clarificationsEnabled:u,onContentPage:m,setFocusOnTopLevelInput:b,profileLoading:w,profile:E,contentKind:C,hasUnansweredHelpRequests:v}=this.props;if(!e.length){if(t)return r.createElement(c.CircularSpinner,{size:"medium",style:P.noPostsWrapper});const e=m&&(0,y.showMainDiscussionInput)(a,C,d,E,v);return r.createElement(f.View,{style:P.noPostsWrapper},r.createElement(p.LabelLarge,null,h.miscStrings.noPosts),e&&r.createElement(l.default,{onClick:b,style:P.noPostsButton},h.miscStrings.joinTheConversation))}const S=w||E&&E.get("isChildAccount");return r.createElement("ul",null,e.map((e=>r.createElement("li",{key:e,className:(0,s.css)(P.post,!this.isCompactView()&&P.postExtraSpacing)},r.createElement(g.default,{tab:a,postKey:e,newPostKey:n,resetNewPostKeyInfo:o,topicSlug:i,restrictPosting:null!=S&&S,clarificationsEnabled:u,isMaximized:this.isMaximized(),moderatorMode:d.moderatorMode,viewMode:d.viewMode,isProjectFeedback:d.showProjectFeedback})))))}}render(){const{fetchingPosts:e,contentKind:t,isComplete:n,cursor:o,onNextPage:a}=this.props,i=this.getPostsToShow(),s=this.isMaximized();return r.createElement(f.View,{style:[P.wrapper,s&&P.maximizedContainer]},r.createElement(f.View,{style:[!s&&b.listWrapper,!this.isCompactView()&&P.listWrapperExtraSpacing]},"Topic"===t&&r.createElement(y.EnglishLink,{style:P.englishLink}),this.maybeRenderListHeader(i),this.renderContent(i)),o&&!n&&r.createElement(l.default,{onClick:a,spinner:e},h.miscStrings.showMore))}}t.DiscussionList=S;const P=s.StyleSheet.create({wrapper:{width:"100%"},maximizedContainer:{backgroundColor:d.default.white,maxWidth:"100%",padding:"0 20px"},listWrapper:{backgroundColor:d.default.white,paddingTop:u.default.medium_16},listWrapperExtraSpacing:{paddingTop:u.default.xLarge_32},post:(0,a.default)({},b.postWrapper),postExtraSpacing:{marginBottom:u.default.large_24},linkStyledButton:{color:d.default.offBlack64,border:"none",backgroundColor:"transparent",cursor:"pointer",padding:0,margin:0},englishLink:{marginBottom:20},noPostsWrapper:{textAlign:"center",margin:"0 auto",padding:`${u.default.xLarge_32}px 0 ${u.default.medium_16}px`},noPostsButton:{marginTop:u.default.medium_16}}),x={resetNewPostKeyInfo:E.resetNewPostKeyInfoAction,onNextPage:E.getNextPageAction,setFocusOnTopLevelInput:E.setFocusOnTopLevelInputAction};var O=(0,m.compose)(w.default,(0,i.connect)((e=>{const t=e.tabs[e.currentTab];return{fetchingPosts:e.fetchingPosts,tab:e.currentTab,newPostKey:e.newPostKey,cursor:t.cursor,isComplete:t.isComplete,postKeys:t.postKeys,contentKind:e.contentKind}}),x))(S);t.default=O},DDFQ:function(e,t,n){"use strict";var o=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.upvotePost=t.updatePosts=t.undeletePost=t.toggleReplyInputAction=t.stopEditingPostAction=t.stopAcceptingClarificationAction=t.startEditingPostAction=t.startAcceptingClarificationAction=t.setFocusOnTopLevelInputAction=t.resetNewPostKeyInfoAction=t.resetFocusOnTopLevelInputAction=t.resetExpandKeyAction=t.postSuccessAction=t.postSuccess=t.modifyNotificationsAction=t.initializeDiscussionListComponentAction=t.initializeContentAction=t.getNextPageAction=t.flagPost=t.fetchReplies=t.editPost=t.editAcceptedClarificationAction=t.downvotePost=t.deletePost=t.deleteAcceptedClarificationPost=t.clearFlags=t.clearAndFetchPostsAction=t.changeType=t.changeTabAction=t.changeSortByAction=t.addReply=t.acceptClarificationAction=void 0;var a=o(n("pVnL")),r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var i=a?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(o,r,i):o[r]=e[r]}o.default=e,n&&n.set(e,o);return o}(n("4PhQ")),i=o(n("tCRy"));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}const l=e=>t=>{r.default.log(`Failed to ${e} due to: ${t}`)},c=(e,t,n)=>{const o=t(),{contentId:r,currentSort:s,qaExpandKey:c,expandFeedbackType:d,currentTab:p,contentKind:u,youtubeId:f,apiId:m}=o;((e,t)=>{const{currentTab:n}=t();e({type:"updatePosts",tab:n,posts:[],cursor:"",isComplete:!0,totalCount:0})})(e,t),e({type:"fetchingPosts"}),i.default.get(m).fetchPosts({contentKind:u,contentId:r,currentTab:p,youtubeId:f,currentSort:s,qaExpandKey:c,expandFeedbackType:d}).then((t=>{const{feedback:n,cursor:o,totalCount:r,isComplete:s}=t,c={type:"updatePosts",tab:p,posts:n,cursor:o,totalCount:r,isComplete:s};return"clarifications"===p&&"Video"===u&&f?i.default.get(m).fetchAcceptedClarifications({youtubeId:f}).then((t=>{e((0,a.default)({},c,{acceptedClarificationPosts:t}))})).catch(l("fetch accepted clarifications")):e(c),t})).catch(l("fetch posts"))};t.clearAndFetchPostsAction=e=>(e,t)=>c(e,t);t.initializeContentAction=(e,t,n,o,a,r)=>(r,i)=>{r({type:"initializeContent",contentKind:e,contentId:t,youtubeId:n,expandFeedbackType:o,qaExpandKey:a}),c(r,i)};t.initializeDiscussionListComponentAction=(e,t,n,o,a,r)=>(r,i)=>{r({type:"initializeDiscussionListComponent",tab:e,cursor:t,apiId:n}),a?r(d(e,a,t,o)):c(r,i)};t.getNextPageAction=e=>(e,t)=>{const n=t(),{contentId:o,currentSort:a,qaExpandKey:r,expandFeedbackType:s,currentTab:c,contentKind:d,youtubeId:p,apiId:u,tabs:f}=n,m=f[c];m.cursor&&(e({type:"fetchingPosts"}),i.default.get(u).fetchPosts({contentId:o,currentSort:a,qaExpandKey:r,expandFeedbackType:s,currentTab:c,contentKind:d,youtubeId:p,cursor:m.cursor}).then((t=>(e({type:"appendPosts",tab:c,posts:t.feedback,cursor:t.cursor,totalCount:t.totalCount,isComplete:t.isComplete}),t))).catch(l("get next")))};t.changeTabAction=(e,t)=>(t,n)=>{t({type:"changeTab",tab:e}),c(t,n)};t.changeSortByAction=(e,t)=>(t,n)=>{t({type:"changeSortBy",sort:e}),c(t,n)};t.resetExpandKeyAction=()=>({type:"resetExpandKey"});t.resetNewPostKeyInfoAction=()=>({type:"resetNewPostKey"});t.setFocusOnTopLevelInputAction=()=>({type:"setFocusOnTopLevelInput"});t.resetFocusOnTopLevelInputAction=()=>({type:"resetFocusOnTopLevelInput"});t.postSuccessAction=(e,t)=>({type:"postSuccess",post:e,tab:t});t.upvotePost=(e,t)=>(t,n)=>{const{apiId:o}=n();i.default.get(o).upvotePost({postKey:e.key,upVoted:e.upVoted}).catch(l("upvote post")),t({type:"upvotePost",postKey:e.key})};t.downvotePost=(e,t)=>(t,n)=>{const{apiId:o}=n();i.default.get(o).downvotePost({postKey:e.key,downVoted:e.downVoted}).catch(l("downvote post")),t({type:"downvotePost",postKey:e.key})};t.flagPost=(e,t,n)=>(n,o)=>{const{apiId:a}=o();n({type:"flagPost",postKey:e.key,flag:t}),i.default.get(a).flagPost({postKey:e.key,flag:t}).catch(l("flag post"))};t.changeType=(e,t,n)=>(n,o)=>{const{apiId:a}=o();i.default.get(a).changeType({postKey:e.key,intoType:t}).catch(l("change type of post")),n({type:"changePostType",postKey:e.key,postType:t})};t.clearFlags=(e,t)=>(t,n)=>{const{apiId:o}=n();i.default.get(o).clearFlags({postKey:e.key}).catch(l("clear flags")),t({type:"clearFlags",postKey:e.key})};t.deletePost=(e,t)=>(n,o)=>{const{apiId:a}=o();i.default.get(a).deletePost({postKey:e.key},t).then((t=>{t&&n({type:"deletePost",postKey:e.key})}))};t.deleteAcceptedClarificationPost=(e,t)=>(t,n)=>{const{apiId:o}=n();i.default.get(o).deleteAcceptedClarification({clarificationId:e.id}).catch(l("delete accepted clarification")),t({type:"deleteAcceptedClarificationPost",clarificationId:e.id})};t.undeletePost=(e,t)=>(t,n)=>{const{apiId:o}=n();i.default.get(o).undeletePost({postKey:e.key}).catch(l("undelete post")),t({type:"undeletePost",postKey:e.key})};t.editPost=(e,t)=>(t,n)=>{t({type:"editPost",postKey:e.key,content:e.content})};t.acceptClarificationAction=(e,t,n,o,a,s,l,c)=>(e,t)=>{const{youtubeId:n,clarificationBeingAcceptedId:d,apiId:p}=t();if(!n)throw new r.KAError("Can't accept a clarification if we don't know the youtubeId.",r.Errors.Internal);if(!d)throw new r.KAError("Can't accept a clarification if we don't have a clarificationBeingAcceptedId.",r.Errors.Internal);i.default.get(p).acceptClarification({kaid:o,youtubeId:n,openTimestamp:s,closeTimestamp:l,text:a}).then((t=>{i.default.get(p).deletePost({postKey:d},c).then((n=>{n&&e({type:"acceptClarification",originalClarificationId:d,clarification:t})}))}))};t.startAcceptingClarificationAction=e=>t=>{t({type:"startAcceptingClarification",clarificationId:e})};t.startEditingPostAction=e=>t=>{t({type:"startEditingPost",postKey:e})};t.editAcceptedClarificationAction=(e,t,n,o)=>(o,s)=>{const{acceptedClarificationPosts:c,postBeingEditedKey:d,apiId:p}=s(),u=c.find((e=>e.id===d));if(!u)throw new r.KAError(`The clarification you're trying to edit doesn't seem to exist!\nThe posts's key is:\n${d||"unknown"}`,r.Errors.Internal);const f=(0,a.default)({},u,{openTimestamp:t,closeTimestamp:n,text:e,youtubeId:u.youtubeId});i.default.get(p).editAcceptedClarification((0,a.default)({},f)).then((e=>{o({type:"editAcceptedClarification",clarification:e}),o({type:"stopEditingPost"})})).catch(l("edit accepted clarification"))};t.stopAcceptingClarificationAction=()=>e=>{e({type:"stopAcceptingClarification"})};t.stopEditingPostAction=()=>e=>{e({type:"stopEditingPost"})};t.modifyNotificationsAction=(e,t,n)=>(o,r)=>{const{apiId:s}=r();i.default.get(s).modifyNotificationsFlag({postKey:e,enable:t},n).then((t=>{if(null==t)return l("modify notification settings");const n=r().posts[e];o({type:"updatePost",post:(0,a.default)({},n,{notifyOnAnswer:t})})})).catch(l("modify notification settings"))};t.fetchReplies=e=>(t,n)=>{const{apiId:o}=n();i.default.get(o).fetchReplies({postKey:e}).then((n=>{t({type:"updateReplies",parentKey:e,replies:n})})).catch(l("fetch replies"))};t.addReply=(e,t,n,o)=>(o,a)=>{const{apiId:r}=a();i.default.get(r).addReply({postKey:e,text:t,topic_slug:n}).then((t=>{o({type:"addReply",post:t,parentKey:e})})).catch(l("add reply"))};t.postSuccess=(e,t)=>(n,o)=>{n({type:"postSuccess",post:e,tab:t})};t.toggleReplyInputAction=e=>(t,n)=>{t({type:"toggleReplyInput",postKey:e})};const d=(e,t,n,o)=>(a,r)=>{a({type:"updatePosts",tab:e,posts:t,cursor:n,isComplete:o,totalCount:t.length}),a({type:"changeTab",tab:e})};t.updatePosts=d},EFbQ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if(null===e)return"";const a=o._(t||"");if("TOO_BRIEF"===e)return o._("Your %(feedbackType)s is too brief. Try writing a more specific %(feedbackType)s.",{feedbackType:a});if("BAD_CAPITALS"===e)return o._("Try using standard capitalization to improve your %(feedbackType)s's quality.",{feedbackType:a});if("TOO_MANY_REPEATS"===e)return o._('Try to avoid repeating the "%(letter)s" character so many times.',{letter:n});if("TIP_OR_THANKS"===e)return o._("Are you trying to post a tip or thanks? Check out the Tips & Thanks section above.");return""};var o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var o={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var s=r?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(o,i,s):o[i]=e[i]}o.default=e,n&&n.set(e,o);return o}(n("HEOz"));function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}},F4p2:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=p(n("q1tI")),a=n("mR6N"),r=n("Vxy9"),i=n("JimW"),s=n("i4Cj"),l=p(n("TqM9")),c=p(n("HEOz"));function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(d=function(e){return e?n:t})(e)}function p(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=d(t);if(n&&n.has(e))return n.get(e);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var i=a?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(o,r,i):o[r]=e[r]}return o.default=e,n&&n.set(e,o),o}const u=a.StyleSheet.create({formattingOptionsTable:{width:"100%",marginTop:14},formattingOptionsRow:{borderTop:l.border,borderBottom:l.border},formattingOptionsHeaderRow:{backgroundColor:l.secondaryBackgroundColor,textAlign:"left",textTransform:"uppercase"},formattingOptionsRowContent:{padding:"14px 16px 16px 16px"},italic:{fontStyle:"italic"},code:{fontFamily:"Inconsolata"},codeSnippet:{height:231}});var f=()=>o.createElement("table",{className:(0,a.css)(u.formattingOptionsTable)},o.createElement("thead",null,o.createElement("tr",{className:(0,a.css)(u.formattingOptionsRow,u.formattingOptionsHeaderRow)},o.createElement("th",{scope:"col"},o.createElement(i.View,{style:u.formattingOptionsRowContent},s.formattingOptionsStrings.rawTextHeading)),o.createElement("th",{scope:"col"},o.createElement(i.View,{style:u.formattingOptionsRowContent},s.formattingOptionsStrings.formattedTextHeading)))),o.createElement("tbody",null,o.createElement("tr",{className:(0,a.css)(u.formattingOptionsRow)},o.createElement("td",null,o.createElement(i.View,{style:u.formattingOptionsRowContent},"*",s.formattingOptionsStrings.bold,"*")),o.createElement("td",null,o.createElement(i.View,{style:u.formattingOptionsRowContent,"aria-labelledby":"bold","aria-describedby":"boldDescription"},o.createElement(r.LabelLarge,{id:"bold"},s.formattingOptionsStrings.bold),o.createElement("span",{className:"sr-only",id:"boldDescription"},s.formattingOptionsStrings.boldDescription)))),o.createElement("tr",{className:(0,a.css)(u.formattingOptionsRow)},o.createElement("td",null,o.createElement(i.View,{style:u.formattingOptionsRowContent},c.doNotTranslate("_"),s.formattingOptionsStrings.italics,c.doNotTranslate("_"))),o.createElement("td",null,o.createElement(i.View,{style:[u.formattingOptionsRowContent,u.italic],"aria-labelledby":"italics","aria-describedby":"italicsDescription"},o.createElement("span",{id:"italics"},s.formattingOptionsStrings.italics),o.createElement("span",{className:"sr-only",id:"italicsDescription"},s.formattingOptionsStrings.italicsDescription)))),o.createElement("tr",{className:(0,a.css)(u.formattingOptionsRow)},o.createElement("td",null,o.createElement(i.View,{style:u.formattingOptionsRowContent},"`",s.formattingOptionsStrings.code,"`")),o.createElement("td",null,o.createElement(i.View,{style:[u.formattingOptionsRowContent,u.code],"aria-labelledby":"code","aria-describedby":"codeDescription"},o.createElement("span",{id:"code"},s.formattingOptionsStrings.code),o.createElement("span",{className:"sr-only",id:"codeDescription"},s.formattingOptionsStrings.codeDescription)))),o.createElement("tr",{className:(0,a.css)(u.formattingOptionsRow)},o.createElement("td",null,o.createElement(i.View,{style:u.formattingOptionsRowContent},o.createElement(i.View,null,c.doNotTranslate("```if (x < 0) {")),o.createElement(i.View,null,"    ",c.doNotTranslate("return;")),o.createElement(i.View,null,c.doNotTranslate("&#125;```")))),o.createElement("td",null,o.createElement(i.View,{style:[u.formattingOptionsRowContent,u.code],"aria-describedby":"codeSnippetDescription"},o.createElement(i.View,null,c.doNotTranslate("if (x < 0) {")),o.createElement(i.View,null,"    ",c.doNotTranslate("return;")),o.createElement(i.View,null,c.doNotTranslate("&#125;")),o.createElement("span",{className:"sr-only",id:"codeSnippetDescription"},s.formattingOptionsStrings.codeDescription))))));t.default=f},HbaH:function(e,t,n){"use strict";var o=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n("pVnL")),r=A(n("q1tI")),i=o(n("i8i4")),s=n("/MKj"),l=n("mR6N"),c=n("Vxy9"),d=n("JimW"),p=n("JasB"),u=o(n("Pwnf")),f=n("z8VS"),m=n("Pk2J"),g=o(n("mt3D")),y=o(n("mEQP")),h=o(n("EFbQ")),b=A(n("6OHE")),w=o(n("cfQQ")),E=A(n("4PhQ")),C=n("skGw"),v=o(n("QCGh")),S=n("3xyp"),P=A(n("TqM9")),x=n("i4Cj"),O=n("AE4M"),k=n("DDFQ");function T(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(T=function(e){return e?n:t})(e)}function A(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=T(t);if(n&&n.has(e))return n.get(e);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var i=a?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(o,r,i):o[r]=e[r]}return o.default=e,n&&n.set(e,o),o}const I=b.domainColors("default").domain1,M=()=>r.createElement("a",{href:(0,S.getZendeskCommunityLink)(),className:(0,l.css)(j.helpLink)},x.footerStrings.helpCenter);class K extends r.Component{constructor(e){super(e),this.editingOrAcceptingClarification=()=>!!(this.props.editing||this.props.acceptingClarification||this.props.editingAcceptedClarification),this.handleWindowKeyup=e=>{"Tab"===e.key&&this.textarea&&document.activeElement===this.textarea&&this.setState({hideFocusOutline:!1})},this.handleFocus=()=>{this.setState({textareaExpanded:!0})},this.collapseTextarea=()=>{if(!this._isMounted)return;this.setState({hideFocusOutline:!0,textareaExpanded:!1,formattingOptionsExpanded:!1,previewExpanded:!1});const{onToggleFormattingOptionsExpanded:e,onTogglePreviewExpanded:t}=this.props;e&&e(!1),t&&t(!1)},this.handleDocumentInteraction=e=>{if(!this.container)return;const t=e.target;this.container.contains(t)||this.collapseTextarea()},this.getSanitizedText=e=>{if(e&&e.length){const t=e.trim();if(t.length)return t}return null},this.handleTextChange=e=>{let t=!0;const n=this.getSanitizedText(e.target.value);n&&(t=!1),this.setState({postContent:n,submitButtonDisabled:t})},this.updateUI=e=>{const{onPostSuccess:t,tab:n,editing:o,onEditPost:a}=this.props;let r=!1;const i=(0,h.default)(e.feedbackCode,e.feedbackType,e.feedbackChar);e.showLowQualityNotice?this._isMounted&&this.setState({submitStatus:"failed",isLowQuality:!0,feedbackEditTip:i||""}):(o?a(e,e.content):this.textarea&&(this.textarea.value=""),t(e,n),r=!0,this.collapseTextarea(),this._isMounted&&this.setState({postContent:"",submitStatus:"ready",submitButtonDisabled:true,isLowQuality:!1}))},this.getBaseSubmitUrl=()=>{const{isAnswer:e,tab:t,feedbackKey:n,youtubeId:o}=this.props;let a=this.props.contentKind?this.props.contentKind.toLowerCase():null,r=this.props.contentId;if("video"===a&&"clarifications"===t&&o&&(a="youtubevideo",r=o),!e&&r&&a&&t)return`/api/internal/discussions/${a}/${r}/${t}`;if(e&&n)return`/api/internal/questions/${n}/answers`;throw new E.KAError("We don't have enough information to submit this type of post.",E.Errors.Internal)},this.getPlaceholderText=()=>{const{isReply:e,isAnswer:t,tab:n}=this.props;return e?x.postStrings.replyCommentPlaceholder:!t&&n&&x.tabsStrings[n]?x.tabsStrings[n].placeholder:t&&"projecthelp"===n?x.postStrings.answerPlaceholder:x.postStrings.replyPlaceholder},this.getTextareaLabel=()=>{const{isReply:e,isAnswer:t,tab:n,acceptingClarification:o}=this.props;return e?x.postStrings.comment:t&&"projecthelp"===n?x.postStrings.answer:t?x.postStrings.reply:n&&x.tabsStrings[n]?x.tabsStrings[n].textAreaLabel:o?x.miscStrings.acceptedClarificationLabel:""},this.handleSubmit=()=>{const{feedbackKey:e,topicSlug:t,isAnswer:n,isReply:o,onAddReply:a,postKey:r,acceptingClarification:i,editingAcceptedClarification:s,onSubmitAcceptedClarification:l}=this.props,{postContent:c,isFromAuthor:d,submitStatus:p,isLowQuality:u}=this.state;if(!c||"submitting"===p)return;if((i||s)&&l&&c)return void l(c);if(!r&&o&&e&&c)return this.setState({submitStatus:"submitting"}),void a(e,c,t);const f={text:c,shownLowQualityNotice:u,topic_slug:"",fromVideoAuthor:d};n||(f.topic_slug=t);let m=this.getBaseSubmitUrl(),g="POST";r&&(m+=`/${r}`,g="PUT"),m+="?casing=camel",this.setState({submitStatus:"submitting",feedbackEditTip:""}),(0,C.khanFetch)(m,{method:g,body:JSON.stringify(f),headers:{"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{this._isMounted&&this.updateUI(e)})).catch((e=>{E.default.error("Failed to submit post!",E.Errors.Internal,e),this._isMounted&&this.setState({submitStatus:"failed"})}))},this.renderTextarea=e=>{const{isAnswer:t,isReply:n,editing:o}=this.props,{hideFocusOutline:i,textareaExpanded:s,submitStatus:c,feedbackEditTip:p}=this.state,u="submitting"===c,f=this.getPlaceholderText(),m=s&&p,g=s&&!t&&!n&&!o,y=[j.textareaContainer,!!m&&j.textareaContainerError,s&&(n||this.editingOrAcceptingClarification()?j.replyTextareaContainerExpanded:j.textareaContainerExpanded)],h=[j.textareaField,(t||this.editingOrAcceptingClarification())&&j.textareaFieldForAnswer,g&&j.textareaFieldExpanded,i&&j.textareaNoFocusOutline,m&&j.textareaFieldError],b=n?{rows:1}:null;return r.createElement(d.View,{style:y},r.createElement("textarea",(0,a.default)({id:e,className:(0,l.css)(h),placeholder:`${f}`,"aria-label":f,onFocus:this.handleFocus,onBlur:()=>this.setState({hideFocusOutline:!0}),onClick:()=>this.setState({hideFocusOutline:!0}),onChange:this.handleTextChange,onKeyUp:this.handleTextChange,ref:e=>this.textarea=e,disabled:u},b)))},this.renderFooter=()=>{const{tab:e,isAnswer:t,isReply:n,editing:o,acceptingClarification:a,editingAcceptedClarification:i,onToggleFormattingOptionsExpanded:s,onTogglePreviewExpanded:l,onCancel:c}=this.props,{formattingOptionsExpanded:d,previewExpanded:p,submitButtonDisabled:u,submitStatus:f,textareaExpanded:m}=this.state,g=a||i,h=!!(m||t||o)&&!a;return r.createElement(y.default,{tab:e,content:this.state.postContent||"",isAnswer:t,isReply:n,editing:o,acceptingClarification:g,submitButtonDisabled:u&&!g,submitStatus:f,onSubmit:this.handleSubmit,onCancel:c,canShowFormattingOptions:h,formattingOptionsExpanded:d,onToggleFormattingOptionsExpanded:e=>{s&&s(e),this.setState({formattingOptionsExpanded:e})},previewExpanded:p,onTogglePreviewExpanded:e=>{l&&l(e),this.setState({previewExpanded:e})}})},this.state={hideFocusOutline:!0,textareaExpanded:!1,formattingOptionsExpanded:!1,previewExpanded:!1,postContent:e.initialPostContent,submitButtonDisabled:!0,submitStatus:"ready",isLowQuality:!1,feedbackEditTip:"",isFromAuthor:!1}}UNSAFE_componentWillMount(){const{isAnswer:e,isReply:t}=this.props;e||t||!(0,O.userHasJustLoggedIn)(window.location)||this.setState({hideFocusOutline:!1})}componentDidMount(){const{isAnswer:e,isReply:t}=this.props;this._isMounted=!0;const{textarea:n}=this;n&&!e&&!t&&(0,O.userHasJustLoggedIn)(window.location)&&n.focus({preventScroll:!0}),n&&this.props.autoFocus&&n.focus(),n&&(n.value=this.props.initialPostContent),document.addEventListener("keyup",this.handleWindowKeyup),document.addEventListener("mousedown",this.handleDocumentInteraction),document.addEventListener("touchstart",this.handleDocumentInteraction)}UNSAFE_componentWillUpdate(e,t){const{textarea:n}=this;n&&e.autoFocus&&this.state.hideFocusOutline&&this.setState({hideFocusOutline:!1}),e.newPostKey&&"submitting"===this.state.submitStatus&&(this.textarea&&(this.textarea.value=""),this.collapseTextarea(),this.setState({submitStatus:"ready",submitButtonDisabled:!0,isLowQuality:!1}),this.props.resetNewPostKeyInfo&&this.props.resetNewPostKeyInfo())}componentDidUpdate(e,t){const{textarea:n}=this;n&&this.props.autoFocus&&!e.autoFocus&&(setTimeout((()=>n&&n.focus()),0),this.props.resetFocusOnTopLevelInput())}componentWillUnmount(){this._isMounted=!1,document.removeEventListener("keyup",this.handleWindowKeyup),document.removeEventListener("mousedown",this.handleDocumentInteraction),document.removeEventListener("touchstart",this.handleDocumentInteraction)}getIsModerator(){const{profile:e}=this.props;return!!e&&e.get("isModerator")}render(){const{tab:e,isAnswer:t,isReply:n,showAvatar:o,clarificationsEnabled:a,contentKind:s}=this.props,{textareaExpanded:u,feedbackEditTip:m,isFromAuthor:y}=this.state,h=this.getTextareaLabel(),b=e&&x.tabsStrings[e]||{},w=!t&&b.tipLabel,E=!t&&b.tipContents,C=u&&m,S=u||t||this.editingOrAcceptingClarification(),P=u&&!t&&!n&&!this.editingOrAcceptingClarification(),O="clarifications"!==e&&a,k=e=>{const a=e.get("content-input");return r.createElement(d.View,{style:n?j.replyContainer:j.container,ref:e=>this.container=i.default.findDOMNode(e)},r.createElement(d.View,{"aria-live":"polite",style:j.errorText},C&&r.createElement(c.Body,null,m)),r.createElement(d.View,{style:[j.textAreaHeading,o&&j.textAreaHeadingMargin]},r.createElement("label",{htmlFor:a},r.createElement(c.Body,null,h)),r.createElement(p.Spring,null),t&&"scratchpad"!==s&&this.getIsModerator()?r.createElement(f.Checkbox,{label:x.postStrings.fromTheAuthor,style:j.postAsAuthorCheckbox,checked:y,onChange:e=>this.setState({isFromAuthor:e})}):null),r.createElement(d.View,{style:j.expandableContainer},o&&r.createElement(d.View,{style:j.avatarContainer},r.createElement(g.default,{showCurrentUserAvatar:!0})),r.createElement(d.View,{style:j.textareaAndTipsContainer},this.renderTextarea(a),S&&this.renderFooter(),P&&r.createElement(d.View,null,r.createElement(d.View,{style:j.tip},r.createElement(d.View,{style:j.tipHeading},r.createElement(c.LabelLarge,null,w)),E),r.createElement(d.View,{style:j.helpLinksContainer},r.createElement(M,null),O&&r.createElement(v.default,{className:(0,l.css)(j.helpLink),onClick:this.props.onReportMistake},x.footerStrings.reportMistake))))))};return r.createElement(d.UniqueIDProvider,{mockOnFirstRender:!0,scope:"discussion-input"},(e=>r.createElement("form",null,k(e))))}}K.defaultProps={initialPostContent:"",editing:!1,showAvatar:!0};const j=l.StyleSheet.create({container:{backgroundColor:b.colors.white},replyContainer:{backgroundColor:u.default.offWhite},errorText:{marginLeft:64,color:u.default.red},expandableContainer:{flexDirection:"row"},avatarContainer:{marginRight:P.avatarFormSpace},textareaAndTipsContainer:{width:"100%"},textAreaHeading:{flexDirection:"row"},textAreaHeadingMargin:{marginLeft:56},postAsAuthorCheckbox:{minWidth:148,marginTop:4},textareaContainer:{marginTop:4,marginBottom:0,borderRadius:4,flex:1,border:P.border,backgroundColor:u.default.white},textareaContainerExpanded:{borderBottomRightRadius:0,borderBottomLeftRadius:0},replyTextareaContainerExpanded:{paddingBottom:7},textareaContainerError:{borderColor:u.default.red,backgroundColor:P.errorBackgroundColor},textareaField:{boxSizing:"border-box",border:"none",resize:"vertical",width:"98%",fontSize:16,lineHeight:1.38,transition:`min-height ${b.standardTransition}`,minHeight:34,overflow:"auto",padding:"8px 12px",margin:"1px 0px 1px 1px",":focus":{outline:"auto"},"::placeholder":{color:`solid 1px ${u.default.offBlack16}`,fontSize:16,lineHeight:1.38}},textareaFieldForAnswer:{minHeight:62},textareaFieldError:{backgroundColor:P.errorBackgroundColor},textareaFieldExpanded:{minHeight:P.textareaMinHeight,overflow:"auto"},textareaNoFocusOutline:{":focus":{outline:"none"}},tip:{marginTop:24,marginBottom:16,padding:24,borderRadius:2,backgroundColor:P.secondaryBackgroundColor},tipHeading:{marginBottom:8},helpLinksContainer:{textAlign:"right"},helpLink:{color:I,textDecoration:"none",":hover":{textDecoration:"underline"}}}),F={onAddReply:k.addReply,onEditPost:k.editPost,resetFocusOnTopLevelInput:k.resetFocusOnTopLevelInputAction};var R=(0,m.compose)(w.default,(0,s.connect)((e=>({newPostKey:e.newPostKey,youtubeId:e.youtubeId})),F))(K);t.default=R},IZy4:function(e,t,n){"use strict";var o=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.getTimestampSecondsFromText=t.getTimestampFromSeconds=t.formatContent=t.VideoTimestampLink=void 0;var a=l(n("q1tI")),r=l(n("HEOz")),i=o(n("wINb"));function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function l(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var i=a?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(o,r,i):o[r]=e[r]}return o.default=e,n&&n.set(e,o),o}const c=/(\d{1,3}):([0-5]\d)/g;t.getTimestampSecondsFromText=e=>{let t=0,n=20;const o=c.exec(e);return o&&(t=parseFloat(o[1]),n=parseFloat(o[2])),60*t+n};t.getTimestampFromSeconds=e=>{const t=Math.floor(e/60),n=e-60*t,o=t.toString(),a=n.toString();return{minutes:o,seconds:a.length>1?a:0+a}};const d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},p=e=>d[e],u=/[&<>"'`=]/,f=/[&<>"'`=]/g,m=(e,t,n,o)=>{const a=`<img src=${(0,i.default)("/images/play.png")} class='youTubePlayIcon' aria-hidden="true" alt="" />`;return`<div class='youTubeLink' data-seconds='${60*Number(t)+Number(n)}' tabindex='0' role='link' aria-label='${`${e} ${r._("Click to jump to %(timestamp)s in video",{timestamp:e})}`}'>${o||`${a} ${e}`}</div>`},g=(e,t,n)=>m(e,t,n);t.VideoTimestampLink=e=>a.createElement("span",{dangerouslySetInnerHTML:{__html:m(e.timestamp,e.minutes,e.seconds,e.children)}});t.formatContent=(e,t)=>{let n=(e=>{if("string"!=typeof e){if(e&&e.toHTML)return e.toHTML();if(null==e)return"";if(!e)return e+"";e=""+e}return u.test(e)?e.replace(f,p):e})(e);return n=n.replace(/[\n]/g,"<br>"),n=n.replace(/(\W|^)_(\S.*?\S)_(\W|$)/g,(function(e,t,n,o){return t+"<em>"+n+"</em>"+o})),n=n.replace(/(\W|^)\*(\b.*?\b)\*(\W|$)/g,(function(e,t,n,o){return t+"<strong>"+n+"</strong>"+o})),n=n.replace(/&#x60;&#x60;&#x60;(.*?)&#x60;&#x60;&#x60;/gm,(function(e,t){return"<pre><code class='discussion-code-format discussion-code-block'>"+(t=(t=t.replace(/^\s*(<br>)+/,"")).replace(/(<br>)+\s*$/,""))+"</code></pre>"})),n=n.replace(/&#x60;(.*?)&#x60;/g,(function(e,t){return"<code class='discussion-code-format discussion-code-inline'>"+t+"</code>"})),n=((e,t)=>e.replace(/\b(?:(?:https?:\/\/|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>&]+|&amp;|\((?:[^\s()<>]|(?:\([^\s()<>]+\)))*\))+(?:\((?:[^\s()<>]|(?:\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’&]))/gi,(e=>{if(!/^https?:\/\//.test(e)){if(!e.match(/[^\/]*khanacademy.org|^\//))return e;e="https://"+e}return`<a  href="${e}" ${t?'rel="nofollow"':""}>${e}</a>`})))(n,t),n=n.replace(c,g),n}},KPIR:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var i=a?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(o,r,i):o[r]=e[r]}o.default=e,n&&n.set(e,o);return o}(n("q1tI")),a=n("mR6N"),r=n("i4Cj"),i=n("4Arr");function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}function l(e,t){return Array.prototype.filter.call(e,t)}function c(e){const t=l(e,(e=>e.classList.contains("overall-eval-info"))),n=t.length>0?t[0].textContent:"";return 0===n.length?null:o.createElement("div",{className:(0,a.css)(p.moreInfo)},o.createElement("strong",null,r.evalStrings.fromTheEvaluator),o.createElement("div",{dangerouslySetInnerHTML:{__html:(0,i.formatContent)(n,!0)}}))}class d extends o.Component{render(){const{post:e}=this.props,{content:t,question:n}=e,s=e.sumVotesIncremented>1,d=function(e){const t=document.implementation.createHTMLDocument();return t.body?(t.body.innerHTML=e,t.body.children||new HTMLCollection):new HTMLCollection}(t),u=l(d,(e=>{const t="li"===e.tagName.toLowerCase(),n=e.classList.contains("pass");return t&&!n})),f=s?r.evalStrings.projectPassedEval:r.evalStrings.projectFailedEval;let m=null;if(s){const e=c(d);e&&(m=o.createElement("div",null,e))}else{const e=u.map((function(e,t){const{primary:n,extra:r}=function(e){const t=(e=e.cloneNode(!0)).querySelector("div");let n="";return t&&(n=t.textContent,t.innerHTML=""),{primary:e.textContent,extra:n}}(e);return o.createElement("li",{key:"objective-"+t},o.createElement("div",{className:(0,a.css)(p.failedObjectiveItem)},o.createElement("strong",null,n)),o.createElement("div",{className:(0,a.css)(p.objectiveMoreInfo),dangerouslySetInnerHTML:{__html:(0,i.formatContent)(r,!0)}}))}));m=o.createElement("div",null,c(d),o.createElement("div",{className:(0,a.css)(p.failedObjectives)},o.createElement("strong",null,r.evalStrings.needsMoreWork),o.createElement("ul",{className:(0,a.css)(p.styledList)},e)))}const g=n&&n.content||"";return o.createElement("div",null,o.createElement("div",null,g),o.createElement("div",{className:"eval-guideline"},o.createElement("div",{className:(0,a.css)(p.evalTitle)},f),m))}}t.default=d;const p=a.StyleSheet.create({moreInfo:{marginTop:20},objectiveMoreInfo:{marginBottom:10},failedObjectiveItem:{marginTop:10},failedObjectives:{marginTop:20},styledList:{marginLeft:16,listStyle:"disc"},evalTitle:{fontSize:"larger"}})},RTsg:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=r(t);if(n&&n.has(e))return n.get(e);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var s=a?Object.getOwnPropertyDescriptor(e,i):null;s&&(s.get||s.set)?Object.defineProperty(o,i,s):o[i]=e[i]}o.default=e,n&&n.set(e,o);return o}(n("q1tI")),a=n("IZy4");function r(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(r=function(e){return e?n:t})(e)}class i extends o.Component{render(){const e=(0,a.formatContent)(this.props.string,!0);return o.createElement("span",{dangerouslySetInnerHTML:{__html:e}})}}t.default=i},RdRB:function(e,t,n){"use strict";var o=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=b(t);if(n&&n.has(e))return n.get(e);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var i=a?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(o,r,i):o[r]=e[r]}o.default=e,n&&n.set(e,o);return o}(n("q1tI")),r=n("mR6N"),i=o(n("lTCR")),s=n("JimW"),l=o(n("Pwnf")),c=o(n("gE8/")),d=n("Vxy9"),p=o(n("eHai")),u=n("8r+/"),f=o(n("wINb")),m=o(n("fXTs")),g=n("i4Cj"),y=n("AE4M");let h;function b(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(b=function(e){return e?n:t})(e)}class w extends a.Component{shouldComponentUpdate(e){return!e.gqlResult.loading}render(){const{gqlResult:{loading:e,data:t}}=this.props;if(e||!t||!t.user)return a.createElement("span",null,g.avatarStrings.findingProfileInformation);const{nickname:n,username:o,avatar:i,bio:l,points:c,isPhantom:p,isActor:u,isCoachedByActor:m,userSummaryIsVisibleToActor:h,actorHasUserScopedPermission:b}=t.user,w=!(u||m||h||b);return a.createElement(s.View,{style:C.tooltipContainer},a.createElement(s.View,{style:C.avatarContainer},i&&n&&a.createElement("img",{className:(0,r.css)(C.tooltipAvatar),src:(0,f.default)(i.imageSrc),alt:g.avatarStrings.getAvatarForUser(i&&(0,y.getAriaAvatarName)(i.name),n)})),a.createElement(s.View,{style:C.tooltipBody},a.createElement(s.View,{style:C.tooltipHeader},a.createElement(d.HeadingSmall,{style:[C.nameText,C.nickname]},p?g.avatarStrings.unclaimedPoints:n),a.createElement(d.LabelMedium,{style:[C.nameText,C.username]},o?"@"+o:null)),a.createElement(d.LabelMedium,{style:C.bio},(0,y.hideExternalLinks)(l)),"sal"===o?a.createElement(d.LabelMedium,{style:C.points},"+∞"):a.createElement(d.LabelMedium,{style:C.points},!c&&0!==c||w?g.avatarStrings.questionMark:"+"+c.toLocaleString())))}}const E=(0,u.gqlOp)((0,i.default)(h||(h=(e=>e)`
    query getUserHoverCardProfile($kaid: String!) {
        user(kaid: $kaid) {
            id
            nickname
            username
            bio
            avatar {
                name
                imageSrc
            }
            points
            isPhantom
            isActor
            isCoachedByActor
            userSummaryIsVisibleToActor
            actorHasUserScopedPermission(capability: CAN_VIEW_USER_IDENTITY)
        }
    }
`))),C=r.StyleSheet.create({tooltipContainer:{flexDirection:"row",width:350},avatarContainer:{marginRight:c.default.xLarge_32,marginTop:c.default.xxSmall_6},tooltipAvatar:{width:64,height:64},tooltipBody:{width:"100%"},tooltipHeader:{flexDirection:"row",alignItems:"flex-end",flexWrap:"wrap",marginTop:c.default.xxSmall_6,marginBottom:c.default.small_12},nameText:{marginTop:c.default.xxSmall_6,maxWidth:272,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},nickname:{marginRight:c.default.small_12},username:{color:l.default.offBlack50,":hover":{textDecoration:"none"}},bio:{marginBottom:c.default.medium_16},points:{color:l.default.darkBlue,textAlign:"right",fontWeight:700,fontSize:16,marginBottom:c.default.small_12}}),v=(0,p.default)((({kaid:e})=>({query:E,fetchPolicy:"cache-first",variables:{kaid:e}})))(w);var S=e=>a.createElement(m.default,null,a.createElement(v,e));t.default=S},XKyD:function(e,t,n){"use strict";var o=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ConfirmDeletionModal=void 0;var a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=u(t);if(n&&n.has(e))return n.get(e);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var i=a?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(o,r,i):o[r]=e[r]}o.default=e,n&&n.set(e,o);return o}(n("q1tI")),r=n("mR6N"),i=n("Uafs"),s=n("JimW"),l=n("Vxy9"),c=n("JasB"),d=o(n("wa3X")),p=n("i4Cj");function u(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(u=function(e){return e?n:t})(e)}const f=({handleClose:e,handleSubmit:t})=>a.createElement(i.OnePaneDialog,{style:{maxHeight:280},role:"alertdialog",title:p.confirmDeletionModalStrings.delete,content:a.createElement(s.View,null,a.createElement(l.Body,null,p.confirmDeletionModalStrings.confirmDeletion)),footer:a.createElement(s.View,{style:m.footer},a.createElement(d.default,{onClick:e,kind:"tertiary"},p.confirmDeletionModalStrings.cancel),a.createElement(c.Strut,{size:16}),a.createElement(d.default,{onClick:t,color:"destructive"},p.confirmDeletionModalStrings.delete))});t.ConfirmDeletionModal=f;const m=r.StyleSheet.create({footer:{flexDirection:"row"}});var g=f;t.default=g},doqZ:function(e,t,n){"use strict";var o=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.DELETE_POST_MUTATION=void 0;var a=n("Xbru"),r=o(n("lTCR"));let i;const s=(0,a.gqlOp)((0,r.default)(i||(i=(e=>e)`
    mutation DeletePostMutation($postKey: String!) {
        hideFeedback(feedbackKey: $postKey) {
            error {
                code
            }
        }
    }
`)));t.DELETE_POST_MUTATION=s},fjY8:function(e,t,n){"use strict";var o=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=f(t);if(n&&n.has(e))return n.get(e);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var i=a?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(o,r,i):o[r]=e[r]}o.default=e,n&&n.set(e,o);return o}(n("q1tI")),r=n("mR6N"),i=n("DzHr"),s=n("JimW"),l=n("Vxy9"),c=o(n("wa3X")),d=n("JasB"),p=o(n("SGU3")),u=n("i4Cj");function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(f=function(e){return e?n:t})(e)}class m extends a.Component{render(){const{flaggedBy:e,flags:t,onCancel:n,onClearAllFlags:o}=this.props;return a.createElement(i.OneColumnModal,{content:a.createElement(s.View,null,a.createElement(l.Title,{style:g.title},u.clearFlagsModalStrings.flagsTitle),e.map(((e,n)=>a.createElement(l.Body,{key:e},a.createElement(p.default,{href:`/profile/${e}/discussion`,target:"_blank"},e)," - ",t[n])))),footer:a.createElement(s.View,{style:g.footer},a.createElement(c.default,{onClick:n,kind:"tertiary"},u.clearFlagsModalStrings.cancel),a.createElement(d.Strut,{size:16}),a.createElement(c.default,{onClick:o},u.clearFlagsModalStrings.clearAllFlags))})}}t.default=m;const g=r.StyleSheet.create({footer:{flexDirection:"row"},title:{marginBottom:24}})},gzgZ:function(e,t,n){"use strict";var o=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var i=a?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(o,r,i):o[r]=e[r]}o.default=e,n&&n.set(e,o);return o}(n("q1tI")),r=n("mR6N"),i=o(n("Pwnf")),s=n("Vxy9");function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}const c=(0,n("JimW").addStyle)("button");class d extends a.Component{render(){const{disabled:e,icon:t,id:n,children:o,onClick:r,style:i}=this.props;return a.createElement(c,{id:n,onClick:r,style:[p.linkStyledButton,p.toolButton,e&&p.disabled,i],disabled:e},t,a.createElement(s.LabelXSmall,{style:p.text},o))}}t.default=d;const p=r.StyleSheet.create({linkStyledButton:{color:i.default.offBlack64,border:"none",backgroundColor:"transparent",cursor:"pointer",padding:0,margin:0,":focus":{outline:"auto"}},toolButton:{display:"flex",alignItems:"center"},text:{marginLeft:5},disabled:{cursor:"default",color:i.default.offBlack32}})},iRWY:function(e,t,n){"use strict";var o=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n("pVnL")),r=y(n("q1tI")),i=n("mR6N"),s=n("JimW"),l=n("Vxy9"),c=o(n("Pwnf")),d=y(n("hCZ8")),p=o(n("Nw73")),u=o(n("oia8")),f=n("i4Cj"),m=y(n("TqM9"));function g(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(g=function(e){return e?n:t})(e)}function y(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=g(t);if(n&&n.has(e))return n.get(e);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var i=a?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(o,r,i):o[r]=e[r]}return o.default=e,n&&n.set(e,o),o}const h=(0,s.addStyle)("button");class b extends r.Component{constructor(...e){super(...e),this.state={flagType:null},this.handleSubmit=()=>{this.props.onClose(this.state.flagType)}}render(){const{onClose:e,post:t,tab:n}=this.props,o=["inappropriate"];return"questions"===n?o.push("shouldBeTipsOrThanks"):"comments"===n&&o.push("shouldBeQuestion"),o.push.apply(o,["lowquality","spam"]),r.createElement(d.default,{style:w.modal,onClose:e},r.createElement(s.View,{style:w.content},r.createElement(l.Title,{style:w.title},f.flagModalStrings.header),r.createElement(s.View,{style:w.post},r.createElement(l.Body,null,t.content)),r.createElement(s.View,null,o.map(((e,t)=>r.createElement(s.View,{key:e,style:[w.row,t>0&&w.separator]},r.createElement(h,{style:w.button,onClick:()=>this.setState({flagType:e})},r.createElement(u.default,{selected:this.state.flagType===e}),r.createElement(l.Body,null,f.flagModalStrings.flags[e].title)),r.createElement(l.Body,{style:w.desc},f.flagModalStrings.flags[e].description)))))),r.createElement(d.ModalFooter,{style:E},r.createElement(p.default,{width:138,color:c.default.blue,onClick:this.handleSubmit,disabled:!this.state.flagType},f.flagModalStrings.submit)))}}t.default=b;const w=i.StyleSheet.create({modal:{width:662,maxHeight:"80%"},title:{marginBottom:24},content:{flex:1,padding:"64px 64px 0px 64px"},row:{padding:"16px 0",flexShrink:0,alignItems:"start"},button:(0,a.default)({},m.notAButton,{display:"inline-flex",flexDirection:"row",alignItems:"center",":focus":{outline:"auto"}}),separator:{borderTop:`solid 1px ${c.default.offBlack16}`},desc:{color:c.default.offBlack64,paddingLeft:24},post:{flex:1,border:`solid 1px ${c.default.offBlack16}`,color:c.default.offBlack64,borderRadius:4,padding:16,overflow:"auto"}}),E={justifyContent:"flex-end",paddingLeft:16,paddingRight:16}},mEQP:function(e,t,n){"use strict";var o=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(n("pVnL")),r=E(n("q1tI")),i=o(n("i8i4")),s=n("mR6N"),l=o(n("wa3X")),c=n("JasB"),d=n("JimW"),p=n("Vxy9"),u=o(n("Q8Wn")),f=o(n("F4p2")),m=n("i4Cj"),g=E(n("6OHE")),y=o(n("uEGL")),h=E(n("TqM9")),b=o(n("RTsg"));function w(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(w=function(e){return e?n:t})(e)}function E(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=w(t);if(n&&n.has(e))return n.get(e);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var i=a?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(o,r,i):o[r]=e[r]}return o.default=e,n&&n.set(e,o),o}const C=g.domainColors("default").domain1;class v extends r.Component{constructor(...e){super(...e),this.renderFormattingOptionsButton=e=>{const{onToggleFormattingOptionsExpanded:t,formattingOptionsExpanded:n}=this.props,o=!n,a=n?m.footerStrings.hideFormattingOptions:m.footerStrings.showFormattingOptions;return r.createElement(l.default,{kind:"tertiary","aria-expanded":n?"true":"false","aria-controls":e,"aria-label":a,style:(S.button,S.formattingButton),onClick:()=>{t&&t(o)}},a)},this.renderPreviewButton=e=>{const{onTogglePreviewExpanded:t,previewExpanded:n}=this.props,o=!n,a=n?m.footerStrings.hideMarkdownPreview:m.footerStrings.showMarkdownPreview;return r.createElement(l.default,{kind:"tertiary","aria-expanded":n?"true":"false","aria-controls":e,"aria-label":a,style:(S.button,S.formattingButton),onClick:()=>{t&&t(o)}},a)}}componentDidUpdate(e){const{submitButton:t}=this;t&&"failed"===this.props.submitStatus&&"submitting"===e.submitStatus&&setTimeout((()=>t&&t.focus()),0)}getSubmitButtonCopy(){const{tab:e,isAnswer:t,isReply:n,editing:o,acceptingClarification:a,submitStatus:r}=this.props;return"submitting"===r?m.footerStrings.submitting:o?m.postStrings.saveChanges:a?m.postStrings.acceptClarification:n?m.postStrings.comment:!t&&e?m.tabsStrings[e].buttonContents:t&&"projecthelp"===e?m.postStrings.answerButtonContents:m.postStrings.replyButtonContents}renderPreviewArea(){return r.createElement(p.Body,{style:[h.content,S.previewContainer,this.props.previewExpanded&&S.previewContainerExpanded]},r.createElement(b.default,{string:this.props.content}))}render(){const{isReply:e,editing:t,acceptingClarification:n,canShowFormattingOptions:o,formattingOptionsExpanded:a,submitButtonDisabled:s,submitStatus:p,onSubmit:g}=this.props,y=t||n,h="submitting"===p,b=this.getSubmitButtonCopy(),w=n?[S.textareaFooter,S.textareaFooterAcceptingClarification]:S.textareaFooter,E="en"===u.default.kaLocale.slice(0,2);return r.createElement(d.UniqueIDProvider,{mockOnFirstRender:!0,scope:"discussion-post-formatting-options-button"},(t=>r.createElement(d.View,{style:[S.textareaContainerFooter,e&&S.textareaReplyFooter]},r.createElement(d.View,{style:w,"aria-live":"polite"},E&&this.renderPreviewButton(t.get("toggle-preview-button")),!n&&this.renderFormattingOptionsButton(t.get("toggle-button")),r.createElement(d.View,{style:S.buttonContainer},y&&r.createElement(l.default,{kind:"tertiary",onClick:this.props.onCancel,style:S.button},m.postStrings.cancel),y&&r.createElement(c.Strut,{size:8}),r.createElement(l.default,{disabled:s||h,onClick:g,spinner:h,style:S.button,ref:e=>this.submitButton=i.default.findDOMNode(e),"aria-label":b},b))),r.createElement(d.View,null,this.renderPreviewArea()),r.createElement(d.View,{style:[S.formattingOptionsContainer,o&&a&&S.formattingOptionsContainerExpanded],id:t.get("toggle-button")},o&&a&&r.createElement(f.default,null)))))}}t.default=v,v.defaultProps={editing:!1,acceptingClarification:!1};const S=s.StyleSheet.create({textareaContainerFooter:{padding:"12px 16px",border:h.border,borderTop:"none",borderBottomRightRadius:4,borderBottomLeftRadius:4},textareaFooter:{flexDirection:"row",justifyContent:"space-between",[y.default.xsOrSmaller]:{flexDirection:"column"}},textareaReplyFooter:{border:"none",paddingLeft:0,paddingRight:0},textareaFooterAcceptingClarification:{justifyContent:"flex-end"},submitButtonContents:{flexDirection:"row",alignItems:"center",justifyContent:"center"},button:{[y.default.xsOrSmaller]:{width:"calc(100% + 60px)"}},submitButtonSpinner:{marginRight:8},notAButton:(0,a.default)({},h.notAButton),footerSecondaryButton:{color:C,marginRight:16,":hover":{textDecoration:"underline"},[y.default.xsOrSmaller]:{width:"100%",marginBottom:16,marginRight:0}},previewContainer:{display:"none"},previewContainerExpanded:{borderTop:h.border,borderBottom:h.border,boxSizing:"border-box",marginTop:16,marginBottom:16,display:"block",minHeight:h.textareaMinHeight,transition:`min-height ${g.standardTransition}`,overflow:"auto"},formattingOptionsContainer:{display:"none"},formattingOptionsContainerExpanded:{display:"flex"},formattingLabel:{fontWeight:"bold"},formattingButton:{[y.default.xsOrSmaller]:{width:"100%"}},buttonContainer:{flexDirection:"row"}})},mt3D:function(e,t,n){"use strict";var o=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.DATA_QUERY=void 0;var a=C(n("q1tI")),r=n("mR6N"),i=o(n("lTCR")),s=n("JimW"),l=C(n("TqM9")),c=C(n("6OHE")),d=n("8r+/"),p=o(n("HAtO")),u=o(n("wINb")),f=n("i4Cj"),m=o(n("OsXK")),g=o(n("RdRB")),y=o(n("QCGh")),h=n("AE4M"),b=o(n("cfQQ"));let w;function E(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(E=function(e){return e?n:t})(e)}function C(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=E(t);if(n&&n.has(e))return n.get(e);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var i=a?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(o,r,i):o[r]=e[r]}return o.default=e,n&&n.set(e,o),o}const v=(0,d.gqlOp)((0,i.default)(w||(w=(e=>e)`
    query discussionAvatar {
        user {
            id
            avatar {
                name
                imageSrc
            }
        }
    }
`)));t.DATA_QUERY=v;class S extends a.Component{constructor(...e){super(...e),this.renderImage=(e,t,n)=>{let o=null;return o=t?a.createElement("img",{className:(0,r.css)(P.image),src:(0,u.default)(n),alt:f.avatarStrings.getAvatarForUser((0,h.getAriaAvatarName)(t),e)}):a.createElement("img",{className:(0,r.css)(P.image),src:(0,u.default)(n),alt:"","aria-hidden":!0}),a.createElement(s.View,{style:P.container},o)},this.renderTooltip=(e,t,n,o)=>{const r=a.createElement(g.default,{kaid:n}),i=`${f.avatarStrings.getAvatarForUser((0,h.getAriaAvatarName)(t),e)} ${f.avatarStrings.goToUserProfile(e)}`,s=`/profile/${n}/discussion`;return a.createElement(m.default,{content:r,side:"top",offset:12,horizontalAlignment:"left",enablePointerEvents:!0,ariaLive:"polite"},a.createElement(y.default,{href:s,"aria-label":i},o))}}render(){const{showCurrentUserAvatar:e,avatarSrc:t,avatarName:n,username:o,enableProfilePreviewTooltip:r,kaid:i,profile:s}=this.props;let l;return e&&s?a.createElement(p.default,{query:v,fetchPolicy:"cache-and-network"},(({data:e})=>{var a,c;const d=s.get("username"),p=(null==e||null==(a=e.user)?void 0:a.avatar.name)||n,u=(null==e||null==(c=e.user)?void 0:c.avatar.imageSrc)||t;return l=this.renderImage(d,p,u),r?this.renderTooltip(o,n,i,l):l})):(l=this.renderImage(o,n,t),r?this.renderTooltip(o,n,i,l):l)}}S.defaultProps={showCurrentUserAvatar:!1,avatarName:"Default Khan Academy avatar",avatarSrc:"/images/avatars/svg/blobby-green.svg",username:"",kaid:"",enableProfilePreviewTooltip:!1};const P=r.StyleSheet.create({container:{borderRadius:"50%",width:48,minWidth:48,height:48,border:`solid 2px ${l.borderColor}`,backgroundColor:c.colors.white,flexDirection:"row",justifyContent:"center",alignItems:"center"},image:{width:32,height:32}});var x=(0,b.default)(S);t.default=x},oia8:function(e,t,n){"use strict";var o=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=d(n("q1tI")),r=n("mR6N"),i=o(n("Pwnf")),s=n("JimW"),l=d(n("TqM9"));function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}function d(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var i=a?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(o,r,i):o[r]=e[r]}return o.default=e,n&&n.set(e,o),o}class p extends a.Component{render(){const{selected:e}=this.props;return a.createElement(s.View,{"aria-hidden":"true",style:[u.fakeRadioButton,e&&u.selectedFakeRadioButton]})}}t.default=p,p.defaultProps={selected:!1};const u=r.StyleSheet.create({fakeRadioButton:{flexShrink:0,flexGrow:0,borderRadius:"50%",width:16,height:16,border:l.border,marginRight:8,boxSizing:"border-box"},selectedFakeRadioButton:{border:`4px solid ${i.default.blue}`}})},qRmI:function(e,t,n){"use strict";var o=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.AcceptedClarificationInput=void 0;var a=g(n("q1tI")),r=n("/MKj"),i=n("mR6N"),s=o(n("gE8/")),l=n("JimW"),c=o(n("HbaH")),d=n("IZy4"),p=n("i4Cj"),u=g(n("TqM9")),f=n("DDFQ");function m(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(m=function(e){return e?n:t})(e)}function g(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=m(t);if(n&&n.has(e))return n.get(e);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var i=a?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(o,r,i):o[r]=e[r]}return o.default=e,n&&n.set(e,o),o}class y extends a.Component{constructor(e){super(e),this.getStartAndEndFromProps=()=>{const{post:e,editingOrAccepting:t}=this.props;let n=20,o=40;"editing"===t&&e.closeTimestamp?(n=e.openTimestamp,o=e.closeTimestamp):e.content&&(n=(0,d.getTimestampSecondsFromText)(e.content),o=n+20);const a=(0,d.getTimestampFromSeconds)(n),r=(0,d.getTimestampFromSeconds)(o);return{startingTimestampMinutes:Number(a.minutes),startingTimestampSeconds:Number(a.seconds),endingTimestampMinutes:Number(r.minutes),endingTimestampSeconds:Number(r.seconds)}},this.handleSubmitAcceptedClarification=e=>{const{post:t,editingOrAccepting:n,onSubmitClarificationAcceptance:o,onSubmitClarificationEdit:a}=this.props,{startingTimestampMinutes:r,startingTimestampSeconds:i,endingTimestampMinutes:s,endingTimestampSeconds:l}=this.state,c=60*r+i,d=60*s+l;c>=d||("editing"===n?a(e,c,d):t.authorAvatarSrc&&o(t.key,t.authorAvatarSrc,t.authorNickname,t.authorKaid,e,c,d))},this.renderClarificationTimestampInput=e=>{const t=this.state[e];return a.createElement("input",{className:(0,i.css)(h.acceptClarificationInput),value:t,onChange:t=>{const n=t.target.value,o=n.length?Number(n):0;this.setState({[e]:o})},type:"number",min:0,max:59})},this.state=this.getStartAndEndFromProps()}componentDidUpdate(e){this.props.editingOrAccepting===e.editingOrAccepting&&this.props.post.openTimestamp===e.post.openTimestamp&&this.props.post.closeTimestamp===e.post.closeTimestamp&&this.props.post.content===e.post.content||this.setState(this.getStartAndEndFromProps())}render(){const{post:e,contentId:t,topicSlug:n,onCancel:o}=this.props;let r="",i="";return e.key?(r=e.key,i=e.content):e.id&&(r=e.id,i=e.text),a.createElement(l.View,{style:h.replyInputContainer},a.createElement(c.default,{acceptingClarification:!0,tab:"clarifications",contentKind:"Video",contentId:t,topicSlug:n,feedbackKey:r,initialPostContent:i,onCancel:o,onSubmitAcceptedClarification:this.handleSubmitAcceptedClarification}),a.createElement(l.View,{style:h.acceptClarificationContainer},p.miscStrings.timestampFromLabel,this.renderClarificationTimestampInput("startingTimestampMinutes"),":",this.renderClarificationTimestampInput("startingTimestampSeconds"),p.miscStrings.timestampToLabel,this.renderClarificationTimestampInput("endingTimestampMinutes"),":",this.renderClarificationTimestampInput("endingTimestampSeconds")))}}t.AcceptedClarificationInput=y;const h=i.StyleSheet.create({spinner:{marginRight:s.default.xSmall_8},replyInputContainer:{paddingBottom:s.default.large_24},acceptClarificationContainer:{display:"block",marginLeft:u.avatarContainerDiameter+u.avatarFormSpace},acceptClarificationInput:{width:40,padding:0,margin:"16px 4px 0 4px",textAlign:"right"}}),b={onSubmitClarificationAcceptance:f.acceptClarificationAction,onSubmitClarificationEdit:f.editAcceptedClarificationAction};var w=(0,r.connect)((e=>({contentId:e.contentId})),b)(y);t.default=w},"r/58":function(e,t,n){"use strict";var o=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.MODIFY_NOTIFICATIONS_FLAG_MUTATION=void 0;var a=n("Xbru"),r=o(n("lTCR"));let i;const s=(0,a.gqlOp)((0,r.default)(i||(i=(e=>e)`
    mutation notifyAnswer($key: String!, $notifyOnAnswer: Boolean!) {
        modifyNotifyOnAnswer(
            feedbackKey: $key
            notifyOnAnswer: $notifyOnAnswer
        ) {
            feedback {
                feedbackType
                content
                notifyOnAnswer
            }
        }
    }
`)));t.MODIFY_NOTIFICATIONS_FLAG_MUTATION=s},t0zn:function(e,t,n){"use strict";var o=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.createDiscussionStore=void 0;var a=n("ANjH"),r=o(n("TdMD")),i=o(n("wkgs"));const s=(0,a.applyMiddleware)(r.default)(a.createStore),l=()=>s(i.default);t.createDiscussionStore=l;var c=l();t.default=c},tCRy:function(e,t,n){"use strict";var o=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.fetchPostsUrl=t.fetchPostsParameters=t.defaultApi=t.default=void 0;var a=o(n("pVnL")),r=o(n("8OQS")),i=n("R0mg"),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=m(t);if(n&&n.has(e))return n.get(e);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var i=a?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(o,r,i):o[r]=e[r]}o.default=e,n&&n.set(e,o);return o}(n("4PhQ")),l=n("skGw"),c=o(n("gXb0")),d=n("z39W"),p=n("doqZ"),u=n("r/58");const f=["postKey"];function m(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(m=function(e){return e?n:t})(e)}const g=1,y=0,h=-1,b={"top-voted":1,recent:2},w={"Content-Type":"application/json"},E={"Content-Type":"application/x-www-form-urlencoded"},C="/api/internal/discussions",v=e=>`/api/internal/feedback/${e}`,S=e=>t=>{const n=(0,c.default)(t,!0),o=`${e}${n}`;return(0,l.khanFetch)(o).then((e=>e.json()))},P=({contentKind:e,contentId:t,currentTab:n,youtubeId:o})=>{let a=e.toLowerCase(),r=t,i=n;return"Video"===e&&"clarifications"===n&&o&&(a="youtubevideo",r=o),"scratchpad"===e&&"projecthelp"===n&&(i="projectfeedback"),`${C}/${a}/${r}/${i}`};t.fetchPostsUrl=P;const x=({currentTab:e,currentSort:t,qaExpandKey:n,expandFeedbackType:o,cursor:a})=>{const r={casing:"camel",sort:b[t]||1,limit:10,page:0};return a&&(r.cursor=a),n&&o===e&&(r.qa_expand_key=n),r};t.fetchPostsParameters=x;const O=e=>(0,l.khanFetch)(`${C}/voteentity`,{method:"POST",body:(0,c.default)(e),headers:E}),k={inappropriate:"inappropriate",lowquality:"lowquality",shouldBeQuestion:"changetoquestion",shouldBeTipsOrThanks:"changetocomment",spam:"spam",plagiarism:"plagiarism","vote-soliciting":"vote-soliciting","using-disallowed":"using-disallowed"},T={getId:()=>"default",fetchPosts:({contentKind:e,contentId:t,currentTab:n,youtubeId:o,currentSort:a,qaExpandKey:r,expandFeedbackType:i,cursor:s})=>{const l=P({contentKind:e,contentId:t,currentTab:n,youtubeId:o}),c=x({currentTab:n,currentSort:a,qaExpandKey:r,expandFeedbackType:i,cursor:s});return S(l)(c)},modifyNotificationsFlag:async(e,t)=>{var n,o;const a=await t.mutate(u.MODIFY_NOTIFICATIONS_FLAG_MUTATION,{variables:{key:e.postKey,notifyOnAnswer:e.enable}});return null!=a&&null!=(n=a.data)&&null!=(o=n.modifyNotifyOnAnswer)&&o.feedback?a.data.modifyNotifyOnAnswer.feedback.notifyOnAnswer:null},upvotePost:e=>O({entity_key:e.postKey,vote_type:e.upVoted?y:g}),downvotePost:e=>O({entity_key:e.postKey,vote_type:e.downVoted?y:h}),flagPost:e=>{const t=k[e.flag];return(e=>(0,l.khanFetch)(`${C}/flagentity`,{method:"POST",body:(0,c.default)(e),headers:E}))({entity_key:e.postKey,flag:t})},changeType:e=>(0,l.khanFetch)(`${v(e.postKey)}/changetype`,{method:"PUT",body:JSON.stringify({type:e.intoType}),headers:w}),clearFlags:e=>(0,l.khanFetch)(`${v(e.postKey)}/clearflags`,{method:"PUT",headers:w}),deletePost:async(e,t)=>{var n,o,a;const r=await t.mutate(p.DELETE_POST_MUTATION,{variables:{postKey:e.postKey}});return null==(null==r||null==(n=r.data)||null==(o=n.hideFeedback)||null==(a=o.error)?void 0:a.code)},undeletePost:e=>(0,l.khanFetch)(`${v(e.postKey)}/undelete`,{method:"PUT",headers:w}),fetchReplies:e=>{if(!e.postKey){const e=new s.KAError("Cannot fetch replies without a postkey",s.Errors.NotAllowed);return s.default.error(e,s.Errors.Internal),Promise.reject(e)}return(0,l.khanFetch)(`${C}/${e.postKey}/replies?casing=camel`).then((e=>e.json()))},addReply:e=>{const{postKey:t}=e,n=(0,r.default)(e,f);return(0,l.khanFetch)(`${C}/${t}/replies?casing=camel`,{method:"POST",body:JSON.stringify(n),headers:w}).then((e=>e.json()))},fetchAcceptedClarifications:e=>(0,i.getOfficialClarifications)((0,d.getUnsafeGqlClient)(),e.youtubeId),acceptClarification:e=>(0,i.createOfficialClarification)((0,d.getUnsafeGqlClient)(),e.youtubeId,e.kaid,e.text,e.openTimestamp,e.closeTimestamp),editAcceptedClarification:e=>(0,i.updateOfficialClarification)((0,d.getUnsafeGqlClient)(),e.id,e.youtubeId,e.text,e.openTimestamp,e.closeTimestamp),deleteAcceptedClarification:e=>(0,i.deleteOfficialClarification)((0,d.getUnsafeGqlClient)(),e.clarificationId)};t.defaultApi=T;const A={};var I={get:e=>e&&A[e]||(0,a.default)({},T),register(e,t){A[e]=t}};t.default=I},wkgs:function(e,t,n){"use strict";var o=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.calcSumVotes=l,t.default=function(e,t){if(!e)return s;switch(t.type){case"initializeContent":{const{contentKind:n,contentId:o,youtubeId:r,qaExpandKey:i}=t,s="projectfeedback"===t.expandFeedbackType?"projecthelp":t.expandFeedbackType;return(0,a.default)({},e,{contentKind:n,contentId:o,youtubeId:r,qaExpandKey:i,expandFeedbackType:s,currentTab:s||e.currentTab})}case"initializeDiscussionListComponent":{const{tab:n,cursor:o,apiId:r}=t,{tabs:i}=e;return(0,a.default)({},e,{apiId:r||"",contentKind:"Topic",currentTab:n,tabs:(0,a.default)({},i,{[n]:(0,a.default)({},i[n],{cursor:o})})})}case"postSuccess":{const{post:n,tab:o}=t;n.answers=n.answers||[],n.replies=n.replies||[];let i=[],s={};const{questionKey:l}=n;if("answer"===n.type&&l){i=e.tabs[o].postKeys;const t=e.posts[l];t.answers.unshift(n.key),s=(0,a.default)({},e.posts,{[l]:t,[n.key]:n})}else i=[n.key].concat(e.tabs[o].postKeys),s=(0,a.default)({[n.key]:n},e.posts);let c=e.hasUnansweredHelpRequests;if("projecthelp"===n.type)c=!0;else if("projecthelp"===o&&"answer"===n.type&&c){const t=e.tabs.projecthelp.postKeys;if(1===t.length)c=!1;else{const e=t.find((e=>(0,r.isPostUnanswered)(e,s)));c=!!e}}return(0,a.default)({},e,{posts:s,hasUnansweredHelpRequests:c,tabs:(0,a.default)({},e.tabs,{[o]:(0,a.default)({},e.tabs[o],{postKeys:i,totalCount:e.tabs[o].totalCount+1})}),newPostKey:n.key})}case"fetchingPosts":return(0,a.default)({},e,{fetchingPosts:!0});case"updatePosts":{const{tab:n,cursor:o,isComplete:i,totalCount:s}=t,{tabs:l}=e,d=(0,a.default)({},e.posts,c(t.posts)),p=("projecthelp"!==n?t.posts:t.posts.filter((e=>"projecthelp"===e.type))).map((e=>e.key)),u=t.acceptedClarificationPosts||[],f=(t,n)=>"projecthelp"===t.tab?t.posts.some((e=>"projecthelp"===e.type&&(0,r.isPostUnanswered)(e.key,n))):e.hasUnansweredHelpRequests;return(0,a.default)({},e,{fetchingPosts:!1,posts:d,acceptedClarificationPosts:u,hasUnansweredHelpRequests:f(t,d),tabs:(0,a.default)({},l,{[n]:{postKeys:p,cursor:o,isComplete:i,totalCount:s}})})}case"appendPosts":{const{tab:n,cursor:o,isComplete:r}=t,{tabs:i}=e,s=t.posts.filter((t=>!Object.keys(e.posts).includes(t.key))),l=(0,a.default)({},e.posts,c(s)),d=i[n].postKeys,p=s.map((e=>e.key)),u=[].concat(d,p);return(0,a.default)({},e,{fetchingPosts:!1,posts:l,newPostKey:p.length?p[0]:null,tabs:(0,a.default)({},i,{[n]:(0,a.default)({},e.tabs[n],{postKeys:u,cursor:o,isComplete:r})})})}case"updatePost":{const{post:n}=t,o=e.posts[n.key];return(0,a.default)({},e,{posts:(0,a.default)({},e.posts,{[n.key]:(0,a.default)({},o,n)})})}case"updateReplies":{const{replies:n,parentKey:o}=t,r=(0,a.default)({},e.posts,c(n));return(0,a.default)({},e,{posts:(0,a.default)({},r,{[o]:(0,a.default)({},r[o],{replies:n.map((e=>e.key))})})})}case"addReply":{var n;const{parentKey:o,post:r}=t,i=(0,a.default)({},e.posts,{[r.key]:r});i[o].replyCount=null!=(n=i[o].replyCount)?n:0,i[o].replyCount+=1;const s=i[o].replies||[];return i[o].replies=[].concat(s,[r.key]),(0,a.default)({},e,{posts:i,newPostKey:r.key})}case"upvotePost":{const{postKey:n}=t,o=e.posts[n];if(!o)throw new i.KAError("post doesn't exist",i.Errors.Internal);return(0,a.default)({},e,{posts:(0,a.default)({},e.posts,{[n]:(0,a.default)({},o,{downVoted:!1,upVoted:!o.upVoted,sumVotesIncremented:l(o,1)})})})}case"changePostType":{const{postKey:n,postType:o}=t,r=e.posts[n];if("answer"===o)throw new i.KAError("Cannot change the type to an Answer",i.Errors.Internal);if(!r)throw new i.KAError("post doesn't exist",i.Errors.Internal);if(!r.type)throw new i.KAError("post has no type",i.Errors.Internal);if("reply"===r.type||"scratchpad"===r.type||"projecthelp"===r.type||"projecteval"===r.type||"projectevalanswer"===r.type)throw new i.KAError(`posts of type "${r.type}" can't be changed to another type`,i.Errors.Internal);const s={comment:"comments",question:"questions",clarification:"clarifications"}[o],l=e.tabs[s].postKeys;if("answer"===r.type||"projecthelp"===r.type){if(!r.questionKey)throw new i.KAError("answer has no parent",i.Errors.Internal);const t=e.posts[r.questionKey];if(!t)throw new i.KAError("parent post does not exist",i.Errors.Internal);return(0,a.default)({},e,{posts:(0,a.default)({},e.posts,{[t.key]:(0,a.default)({},t,{answers:t.answers.filter((e=>e!==r.key))}),[r.key]:(0,a.default)({},r,{type:o})}),tabs:(0,a.default)({},e.tabs,{[s]:(0,a.default)({},e.tabs[s],{postKeys:[r.key].concat(l),totalCount:e.tabs[s].totalCount+1})})})}const c={comment:"comments",question:"questions",clarification:"clarifications"}[r.type];return(0,a.default)({},e,{posts:(0,a.default)({},e.posts,{[r.key]:(0,a.default)({},r,{type:o})}),tabs:(0,a.default)({},e.tabs,{[c]:(0,a.default)({},e.tabs[c],{postKeys:e.tabs[c].postKeys.filter((e=>e!==r.key)),totalCount:e.tabs[c].totalCount-1}),[s]:(0,a.default)({},e.tabs[s],{postKeys:[r.key].concat(l),totalCount:e.tabs[s].totalCount+1})})})}case"clearFlags":{const{postKey:n}=t,o=e.posts[n];if(!o)throw new i.KAError("post doesn't exist",i.Errors.Internal);return(0,a.default)({},e,{posts:(0,a.default)({},e.posts,{[n]:(0,a.default)({},o,{flags:[],flaggedByUser:!1})})})}case"downvotePost":{const{postKey:n}=t,o=e.posts[n];if(!o)throw new i.KAError("post doesn't exist",i.Errors.Internal);return(0,a.default)({},e,{posts:(0,a.default)({},e.posts,{[n]:(0,a.default)({},o,{downVoted:!o.downVoted,upVoted:!1,sumVotesIncremented:l(o,-1)})})})}case"flagPost":{const{postKey:n,flag:o}=t,r=e.posts[n],s=r.flags||[];if(!r)throw new i.KAError("post doesn't exist",i.Errors.Internal);return(0,a.default)({},e,{posts:(0,a.default)({},e.posts,{[n]:(0,a.default)({},r,{flaggedByUser:!0,flags:[].concat(s,[o])})})})}case"changeTab":return(0,a.default)({},e,{currentTab:t.tab,newPostKey:null});case"changeSortBy":return(0,a.default)({},e,{currentSort:t.sort,newPostKey:null});case"resetNewPostKey":return(0,a.default)({},e,{newPostKey:null});case"setFocusOnTopLevelInput":return(0,a.default)({},e,{focusOnTopLevelInput:!0});case"resetFocusOnTopLevelInput":return(0,a.default)({},e,{focusOnTopLevelInput:!1});case"resetExpandKey":return(0,a.default)({},e,{expandFeedbackType:null,qaExpandKey:null});case"deletePost":{const{currentTab:n}=e,{postKey:o}=t,s=e.posts[o];if(!s)throw new i.KAError("post doesn't exist",i.Errors.Internal);const l=(0,a.default)({},e.posts,{[o]:(0,a.default)({},s,{deleted:!0})}),c="projecthelp"===s.type;let d=e.hasUnansweredHelpRequests;if(c&&d){d=!1;const t=e.tabs.projecthelp.postKeys;t.length>1&&(d=t.some((e=>(0,r.isPostUnanswered)(e,l))))}if("projecthelp"===n&&"answer"===s.type&&!d&&s.questionKey){const t=e.posts[s.questionKey],n=t.answers.some((e=>{const t=l[e];return t&&!t.deleted&&!t.appearsAsDeleted}));d=!n}return(0,a.default)({},e,{hasUnansweredHelpRequests:d,posts:l})}case"deleteAcceptedClarificationPost":{const{clarificationId:n}=t,o=e.acceptedClarificationPosts.filter((e=>e.id!==n));if(o.length===e.acceptedClarificationPosts.length)throw new i.KAError("accepted clarification doesn't exist",i.Errors.Internal);return(0,a.default)({},e,{acceptedClarificationPosts:o})}case"undeletePost":{const{postKey:n}=t,o=e.posts[n];if(!o)throw new i.KAError("post doesn't exist",i.Errors.Internal);return(0,a.default)({},e,{posts:(0,a.default)({},e.posts,{[n]:(0,a.default)({},o,{deleted:!1})})})}case"editPost":{const{postKey:n,content:o}=t,r=e.posts[n];if(!r)throw new i.KAError("post doesn't exist",i.Errors.Internal);return(0,a.default)({},e,{posts:(0,a.default)({},e.posts,{[n]:(0,a.default)({},r,{content:o})})})}case"acceptClarification":{const{originalClarificationId:n,clarification:o}=t,r=(0,a.default)({},e.posts);delete r[n];const s=e.tabs.clarifications.postKeys.filter((e=>e!==n));if(s.length===e.tabs.clarifications.postKeys.length)throw new i.KAError("Couldn't find the clarification to delete.",i.Errors.Internal);return(0,a.default)({},e,{posts:r,acceptedClarificationPosts:[].concat(e.acceptedClarificationPosts,[o]),tabs:(0,a.default)({},e.tabs,{clarifications:(0,a.default)({},e.tabs.clarifications,{postKeys:s,totalCount:e.tabs.clarifications.totalCount-1})})})}case"startAcceptingClarification":return(0,a.default)({},e,{clarificationBeingAcceptedId:t.clarificationId});case"stopAcceptingClarification":return(0,a.default)({},e,{clarificationBeingAcceptedId:null});case"startEditingPost":return(0,a.default)({},e,{postBeingEditedKey:t.postKey});case"stopEditingPost":return(0,a.default)({},e,{postBeingEditedKey:null});case"editAcceptedClarification":{const{clarification:n}=t,o=e.acceptedClarificationPosts.map((e=>e.id===n.id?n:e));return(0,a.default)({},e,{acceptedClarificationPosts:o})}case"toggleReplyInput":return(0,a.default)({},e,{displayInputPostKey:e.displayInputPostKey===t.postKey?null:t.postKey});default:return t.type,e}},t.defaultState=void 0,t.flattenPosts=c;var a=o(n("pVnL")),r=n("AE4M"),i=n("4PhQ");const s={contentKind:"",contentId:"",youtubeId:null,posts:{},acceptedClarificationPosts:[],tabs:{questions:{cursor:"",isComplete:!0,postKeys:[],totalCount:0},comments:{cursor:"",isComplete:!0,postKeys:[],totalCount:0},clarifications:{cursor:"",isComplete:!0,postKeys:[],totalCount:0},projecthelp:{cursor:"",isComplete:!0,postKeys:[],totalCount:0}},newPostKey:null,focusOnTopLevelInput:!1,currentTab:"questions",currentSort:"top-voted",currentCursor:"",qaExpandKey:null,expandFeedbackType:null,displayInputPostKey:null,apiId:"",clarificationBeingAcceptedId:null,postBeingEditedKey:null,hasUnansweredHelpRequests:null};t.defaultState=s;function l(e,t){return 1===t?e.upVoted?e.sumVotesIncremented-1:e.sumVotesIncremented+(e.downVoted?2:1):e.downVoted?e.sumVotesIncremented+1:e.sumVotesIncremented-(e.upVoted?2:1)}function c(e){return e.reduce(((e,t)=>{const n=t.answers||[];return(0,a.default)({},e,c(n),{[t.key]:(0,a.default)({},t,{answers:n.map((e=>e.key)),replies:[]})})}),{})}},y6Wz:function(e,t,n){"use strict";var o=n("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.DiscussionPost=void 0;var a=o(n("pVnL")),r=o(n("8OQS")),i=Z(n("q1tI")),s=Z(n("i8i4")),l=n("/MKj"),c=n("mR6N"),d=o(n("eIwi")),p=n("Pk2J"),u=n("JimW"),f=n("vwLt"),m=n("Vxy9"),g=o(n("wa3X")),y=o(n("Pwnf")),h=o(n("yts4")),b=o(n("gE8/")),w=n("Uafs"),E=n("g8Be"),C=o(n("qRmI")),v=o(n("fjY8")),S=o(n("mt3D")),P=o(n("HbaH")),x=o(n("iRWY")),O=o(n("KPIR")),k=o(n("RTsg")),T=o(n("QCGh")),A=o(n("hSyu")),I=o(n("EIXS")),M=o(n("XKyD")),K=n("AE4M"),j=o(n("mXPZ")),F=n("Y8R6"),R=n("Tipd"),L=o(n("mCQM")),V=o(n("7e7+")),D=o(n("gzgZ")),_=n("SjSX"),B=o(n("cfQQ")),N=o(n("4Du/")),q=o(n("O+Xk")),W=n("i4Cj"),H=Z(n("6OHE")),U=o(n("uEGL")),$=Z(n("TqM9")),z=o(n("qRKg")),Q=o(n("wINb")),J=Z(n("HEOz")),X=n("DDFQ");const G=["style"];function Y(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(Y=function(e){return e?n:t})(e)}function Z(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=Y(t);if(n&&n.has(e))return n.get(e);var o={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var i=a?Object.getOwnPropertyDescriptor(e,r):null;i&&(i.get||i.set)?Object.defineProperty(o,r,i):o[r]=e[r]}return o.default=e,n&&n.set(e,o),o}const{compactStyles:ee}=$,te=(0,u.addStyle)("button"),ne=e=>{const{style:t}=e,n=(0,r.default)(e,G);return i.createElement(te,(0,a.default)({style:[le.linkStyledButton,t]},n))},oe={downvoteSelected:{small:"M8.868 14.48l6.277-10.984A1 1 0 0 0 14.277 2H1.723a1 1 0 0 0-.868 1.496l6.277 10.985a1 1 0 0 0 1.736 0z"},downvote:{small:"M8 11.969L12.554 4H3.446L8 11.969zm.868 2.512a1 1 0 0 1-1.736 0L.855 3.496A1 1 0 0 1 1.723 2h12.554a1 1 0 0 1 .868 1.496L8.868 14.481z"},flagSelected:{small:"M4 11.775V15a1 1 0 0 1-2 0V2.66a1 1 0 0 1 .435-.826c1.04-.712 2.274-.968 3.701-.768 2.448.342 2.734 2.094 4.728 2.342 1.11.138 2.256-.05 3.436-.566a.5.5 0 0 1 .7.458v9.182a.5.5 0 0 1-.18.385c-1.097.914-2.416 1.275-3.956 1.083-2.439-.303-2.744-2.065-4.728-2.342A5.104 5.104 0 0 0 4 11.775z"},flag:{small:"M4 11.775V15a1 1 0 0 1-2 0V2.66a1 1 0 0 1 .435-.826c1.04-.712 2.274-.968 3.701-.768 2.448.342 2.734 2.094 4.728 2.342 1.11.138 2.256-.05 3.436-.566a.5.5 0 0 1 .7.458v9.182a.5.5 0 0 1-.18.385c-1.097.914-2.416 1.275-3.956 1.083-2.439-.303-2.744-2.065-4.728-2.342A5.104 5.104 0 0 0 4 11.775zm6.617-6.382c-1.2-.15-1.981-.57-2.99-1.39l-.279-.228c-.596-.484-.907-.647-1.489-.729-.735-.103-1.34-.035-1.859.195v6.474c.807-.169 1.614-.2 2.413-.088 1.185.166 1.945.585 2.957 1.41l.239.195c.618.503.92.661 1.501.733.743.093 1.354.002 1.89-.274V5.323a7.902 7.902 0 0 1-2.383.07z"},upvoteSelected:{small:"M8.868 2.52l6.277 10.984A1 1 0 0 1 14.277 15H1.723a1 1 0 0 1-.868-1.496L7.132 2.519a1 1 0 0 1 1.736 0z"},upvote:{small:"M3.446 13h9.108L8 5.031 3.446 13zM8.868 2.52l6.277 10.984A1 1 0 0 1 14.277 15H1.723a1 1 0 0 1-.868-1.496L7.132 2.519a1 1 0 0 1 1.736 0z"}},ae=({label:e,onClick:t})=>i.createElement(g.default,{kind:"tertiary",size:"small",style:{marginRight:12},onClick:t},e);class re extends i.Component{static getRepliesExpandedFromProps(e){const{post:t,qaExpandKey:n,newPostKey:o}=e,{replyCount:a}=t;return(0,K.shouldAutoExpandReplies)(t,n)&&null!=a&&a>0&&!o}constructor(e){super(e),this.nodes={},this.srOnlyFlagModal=i.createElement(u.View,{style:z.default.srOnly}," ",W.postStrings.flagAriaLabel),this.srOnlyToolOpensModal=i.createElement(u.View,{style:z.default.srOnly}," ",W.postStrings.toolOpensModal),this.getRepliesContainerId=()=>`${this.props.post.key}-replies-container`,this.setModalVisibility=e=>t=>{this.setState((n=>({isModalOpen:(0,a.default)({},n.isModalOpen,{[t]:e})})))},this.openModal=this.setModalVisibility(!0),this.closeModal=this.setModalVisibility(!1),this.maybeAutoFocusPost=e=>{if(!this.postElement||!this.postElement.focus)return;const{post:t,qaExpandKey:n,newPostKey:o,resetExpandKey:a,resetNewPostKeyInfo:r}=this.props;return o&&o===t.key?(this.postElement.focus(),void r()):n&&t.expandKey===n?(this.postElement.focus(),void a()):void(!this.postElement||e&&e.autoFocusPostOnMount||!this.props.autoFocusPostOnMount||this.postElement.focus())},this.handleUpvote=()=>{if(!j.default.isLoggedIn)return void this.redirectToSignup();const{post:e}=this.props;this.props.onUpvotePost(e);const{sumVotesIncremented:t}=e;if(this.props.post.upVoted){const n=t-1;this.setState({ariaVoteMessage:W.postStrings.ariaAbstained(e,n)})}else{const n=t+(this.props.post.downVoted?2:1);this.setState({ariaVoteMessage:W.postStrings.ariaUpvoted(e,n)})}},this.handleDownvote=()=>{if(!j.default.isLoggedIn)return void this.redirectToSignup();const{post:e}=this.props;this.props.onDownvotePost(e);const{sumVotesIncremented:t}=e;if(this.props.post.downVoted){const n=t+1;this.setState({ariaVoteMessage:W.postStrings.ariaAbstained(e,n)})}else{const n=t-(this.props.post.upVoted?2:1);this.setState({ariaVoteMessage:W.postStrings.ariaDownvoted(e,n)})}},this.handleChangeToQuestion=()=>{this.props.onChangeType(this.props.post,"question")},this.handleChangeToTipsAndThanks=()=>{this.props.onChangeType(this.props.post,"comment")},this.handleChangeToMistakes=()=>{this.props.onChangeType(this.props.post,"clarification")},this.handleClearAllFlags=()=>{const{moderatorMode:e}=this.props;this.props.onClearFlags(this.props.post),e&&this.setState({skipped:!0})},this.handleDelete=()=>{const{moderatorMode:e,onDeletePost:t,post:n,gqlClient:o}=this.props;t(n,o),e&&this.setState({skipped:!0})},this.handleSkip=()=>{this.setState({skipped:!0})},this.handleClickComment=()=>{const{post:e,onShowReplies:t}=this.props,{replyCount:n,replies:o}=e;!this.state.repliesExpanded&&n&&n>0&&o.length!==n&&t(this.props.post.key),j.default.isLoggedIn||n&&0!==n?this.setState({repliesExpanded:!this.state.repliesExpanded}):this.redirectToSignup()},this.handleReplyInputToggle=()=>{const{displayInputPostKey:e,post:t}=this.props;this.props.onToggleReplyInput(t.key),e===t.key&&this.setState({formattingOptionsExpanded:!1})},this.showFlagButton=e=>{const{post:t,profileLoading:n}=this.props;return!("projecteval"===t.type)&&((!this.isCompactView()||"reply"===t.type)&&(!n&&(!e||e&&!e.get("isChildAccount"))))},this.renderPostHeader=()=>{const{post:e,showPostedIn:t,showParentQuestion:n,moderatorMode:o,profile:a}=this.props,{expandKey:r,key:s,authorNickname:l,created:p,date:f,badges:g,permalink:y,focus:h,authorKaid:b}=e,w="scratchpad"===e.type,E=[$.datetime,!this.shouldShowAuthor()&&ee.datetime],C="reply"===e.type,v=o?(0,d.default)(f).toString():(0,d.default)(f).fromNow(),S=(0,K.getDirectLinkSrString)(v,e),P=i.createElement(m.LabelMedium,{style:E},i.createElement(u.View,{"aria-hidden":"true"},v),i.createElement(u.View,{style:z.default.srOnly},S));let x=null;w&&p&&(x=i.createElement(m.LabelMedium,{style:E},"(",W.miscStrings.created,": ",(0,d.default)(p).toString(),")"));const O=y&&r?`${y}?qa_expand_key=${r}`:"";let k=null;e.deleted?k=i.createElement(m.HeadingXSmall,{style:le.deletedPostLabel},W.miscStrings.deleted):e.appearsAsDeleted&&(k=i.createElement(m.HeadingXSmall,{style:le.hiddenPostLabel},W.miscStrings.automaticallyHidden));const A=[$.nameAndDatetime,this.isCompactView()&&se.nameAndDatetime];return i.createElement(u.View,{style:[le.postHeader,C&&le.replyHeader]},i.createElement(u.View,null,i.createElement(u.View,{style:A},this.shouldShowAuthor()&&i.createElement(K.PostAuthorName,{name:l,kaid:b}),i.createElement(T.default,{href:O},P),x,k),t&&!!h&&i.createElement(u.View,{style:le.postedInContainer},i.createElement(m.LabelMedium,{style:le.postedInLabel},W.miscStrings.postedIn),i.createElement(m.LabelMedium,null,i.createElement(T.default,{href:O,style:le.postedInFocusLink},h.translatedTitle||W.miscStrings.untitled))),n&&e.question&&i.createElement(u.View,{style:le.postedInContainer},i.createElement(m.LabelMedium,{style:le.postedInLabel},W.postStrings.answerQuestion,":"),i.createElement(m.Caption,null,e.question&&e.question.content))),g&&0!==g.length&&i.createElement(u.View,{style:le.badges},g.map(((e,t)=>i.createElement(u.View,{key:`discussionBadge${t}${s}`,title:e.translatedDescription},i.createElement("img",{className:(0,c.css)(le.badge),src:(0,Q.default)(e.icons.small),alt:e.translatedDescription}))))),this.renderModeratorOrOwnerActionsAsDropdown(a,$.actionPickerMobile))},this.renderReplyButton=()=>{const{displayInputPostKey:e,post:t}=this.props,n="projecthelp"===t.type?W.postStrings.answer:W.postStrings.reply,o=i.createElement(u.View,{"aria-hidden":"true"},n),a="projecthelp"===t.type?"answer":"reply",r=(0,K.getRespondButtonSrString)(t,a),s=i.createElement(u.View,{style:z.default.srOnly},r);return j.default.isLoggedIn?i.createElement("button",{className:(0,c.css)(le.linkStyledButton),onClick:this.handleReplyInputToggle,"aria-expanded":e===t.key,"aria-controls":(0,K.getAnswerInputId)(t.key)},i.createElement(m.LabelLarge,null,o,s)):i.createElement("button",{className:(0,c.css)(le.linkStyledButton),onClick:()=>this.redirectToSignup()},i.createElement(m.LabelLarge,null,o,s,this.srOnlyToolOpensModal))},this.renderCommentButton=()=>{const{post:e,restrictPosting:t}=this.props,{repliesExpanded:n}=this.state,o=e.replyCount&&e.replyCount>0?W.postStrings.getComments(e.replyCount):i.createElement(u.View,{"aria-hidden":"true"},W.postStrings.comment),a=(0,K.getRespondButtonSrString)(e,"comment"),r=i.createElement(u.View,{style:z.default.srOnly},a);return e.replyCount&&e.replyCount>0||j.default.isLoggedIn&&!t?i.createElement("button",{className:(0,c.css)(le.linkStyledButton),onClick:()=>{this.handleClickComment()},"aria-expanded":n,"aria-controls":this.getRepliesContainerId()},i.createElement(m.LabelLarge,null,o,r)):t?void 0:i.createElement("button",{className:(0,c.css)(le.linkStyledButton),onClick:()=>this.redirectToSignup()},i.createElement(m.LabelLarge,null,o,r,this.srOnlyToolOpensModal))},this.renderPostFooter=()=>{const{post:e,restrictPosting:t,isMaximized:n,profile:o}=this.props,a="reply"===e.type,r="question"===e.type,s="projecthelp"===e.type,l="projecteval"===e.type,c="projectevalanswer"===e.type,d=t||this.isCompactView(),p=i.createElement(u.View,{style:le.postFooterPrimary},(r||s)&&!d&&i.createElement(i.Fragment,null,this.renderReplyButton(),i.createElement(m.LabelMedium,{style:le.separator,"aria-hidden":"true"},"•")),!a&&!l&&!c&&!this.isCompactView()&&this.renderCommentButton(),i.createElement(L.default,null),i.createElement(u.View,{style:$.tools},!a&&!l&&!c&&i.createElement(m.LabelXSmall,{style:le.votesSum},"(",W.postStrings.getVotes(e.sumVotesIncremented),")"),this.renderTools(o)),!n&&this.renderModeratorOrOwnerActions(o,$.actionPickerDesktop)),f=i.createElement(u.View,null,n&&this.renderModeratorOrOwnerActions(o,le.maximizedDesktop));return i.createElement(u.View,{style:le.postFooter},p,f)},this.handleAnswerPostSuccess=(e,t)=>{this.props.onPostSuccess(e,t),this.hideReplyInputField()},this.handleEditingPost=e=>{this.setState({editing:!1})},this.hideReplyInputField=()=>{this.props.onToggleReplyInput(this.props.post.key),this.setState({formattingOptionsExpanded:!1})},this.maybeRenderExpandCollapseButton=(e,t,n,o)=>{if(!n||n.length<2||!o)return;const a=n.length-1,r="projecthelp"===e.type?W.answersStrings.seeAllAnswers(a):W.answersStrings.seeAllReplies(a);return i.createElement(ne,{style:le.expandCollapseButton,onClick:()=>{o.length<n.length&&this.expandAnswers(t),o.length===n.length&&this.collapseAnswers(t)}},i.createElement(m.LabelLarge,null,o.length<n.length?r:W.answersStrings.hideReplies(a)))},this.state={ariaVoteMessage:"",ariaFlagMessage:"",repliesExpanded:re.getRepliesExpandedFromProps(e),editing:!1,formattingOptionsExpanded:!1,previewExpanded:!1,expandedKeys:[],skipped:!1,isModalOpen:{clearFlags:!1,confirmDeletion:!1}}}componentDidMount(){const{qaExpandKey:e,onShowReplies:t,post:n}=this.props,{answers:o,replyCount:a,replies:r,key:i}=n,{repliesExpanded:s}=this.state;(0,K.shouldAutoExpandAnswers)(n,e)&&this.state.expandedKeys.length!==o.length&&this.expandAnswers(i),(s||(0,K.shouldAutoExpandReplies)(n,e))&&a&&r.length!==a&&t(i),this.maybeAutoFocusPost()}componentDidUpdate(e){const t=re.getRepliesExpandedFromProps(e),n=re.getRepliesExpandedFromProps(this.props);!t&&n&&this.setState({repliesExpanded:!0}),this.maybeAutoFocusPost(e)}redirectToSignup(){const{pathname:e,search:t,hash:n}=this.props.location,o=e+t+n;(0,F.redirect)((0,R.getLoginURL)(o))}renderFlagsTooltipContent(){const{post:e}=this.props,{flaggedBy:t,flaggedByKaid:n,flags:o}=e,a=(t||n||[]).map(((e,t)=>({kaid:e,flag:o&&o[t]})));return i.createElement(u.View,null,i.createElement("ul",null,a.map(((e,t)=>i.createElement("li",{key:t},i.createElement(u.View,{style:le.flagsTooltipRow},i.createElement(m.LabelSmall,{style:le.flagsTooltipKaid},e.kaid,":"),i.createElement(m.LabelSmall,{style:le.flagsTooltipText},e.flag||W.miscStrings.unknown)))))))}renderMinimalFlags(e,t,n){return i.createElement(u.UniqueIDProvider,{mockOnFirstRender:!0,scope:"discussion-list"},(o=>i.createElement(I.default,{content:this.renderFlagsTooltipContent(),toggleOnHover:e.length>0,offset:12,a11y:{title:{id:o.get("flag-tt")}}},i.createElement(m.LabelXSmall,{style:[n,le.moderatorFlagged],"aria-labelledby":o.get("flag-tt")},W.postStrings.flagged,t))))}renderFlagButton(e){const{onFlagPost:t,post:n,tab:o}=this.props,a=n.flaggedByUser?y.default.blue:y.default.offBlack64,r=[le.flagText,this.isCompactView()&&se.flagText],s=n.flags||[],l=` (${s.length})`;return(0,K.isModeratorProfile)(e)?this.renderMinimalFlags(s,l,r):i.createElement(u.UniqueIDProvider,{mockOnFirstRender:!0,scope:"discussion-list"},(s=>i.createElement(A.default,{modal:({closeModal:e})=>i.createElement(x.default,{post:n,tab:o,onClose:o=>{o&&(t(n,o),this.setState({ariaFlagMessage:W.postStrings.ariaFlagged})),e()}}),ariaLabel:W.postStrings.flagModal,focusId:s.get("flag")},(t=>i.createElement(D.default,{id:s.get("flag"),icon:i.createElement(h.default,{size:"small",icon:n.flaggedByUser?oe.flagSelected:oe.flag,color:a}),style:[le.toolButton,le.flagTool],disabled:n.flaggedByUser,onClick:()=>{j.default.isLoggedIn?t():this.redirectToSignup()}},i.createElement(u.View,{style:r},n.flaggedByUser?W.postStrings.flagged:W.postStrings.flag,(0,K.isModeratorProfile)(e)&&l,j.default.isLoggedIn?this.srOnlyFlagModal:this.srOnlyToolOpensModal))))))}isCompactView(){const{viewMode:e}=this.props;return"compact"===e}shouldShowAuthor(){const{post:e,moderatorMode:t}=this.props,n="projectevalanswer"===e.type;return!!t||!this.isCompactView()&&!n}renderOpenModals(){const{post:e,schedule:t}=this.props,{isModalOpen:n}=this.state;return i.createElement(i.Fragment,null,i.createElement(w.ModalLauncher,{key:"deletePost",onClose:()=>{this.closeModal("confirmDeletion"),t.animationFrame((()=>{this.actionMenu&&this.actionMenu.focus()}))},opened:n.confirmDeletion,modal:({closeModal:e})=>i.createElement(M.default,{handleClose:e,handleSubmit:()=>{this.handleDelete(),e()}})}),i.createElement(w.ModalLauncher,{key:"clearFlags",onClose:()=>this.closeModal("clearFlags"),opened:n.clearFlags,modal:({closeModal:t})=>i.createElement(v.default,{flaggedBy:e.flaggedBy||e.flaggedByKaid||[],flags:e.flags||[],postKey:e.key,onCancel:t,onClearAllFlags:this.handleClearAllFlags})}))}renderDeleteAction(e,t){const n=(0,K.isModeratorProfile)(e)?this.handleDelete:()=>this.openModal("confirmDeletion");return i.createElement(t,{key:"delete",label:W.postStrings.delete,onClick:n})}getModeratorOrOwnerActions(e,t){const{moderatorMode:n,isProjectFeedback:o}=this.props;if(!e)return[];const{post:a,tab:r,onUndeletePost:s,onModifyNotifications:l,contentKind:c,onStartAcceptingClarification:d,gqlClient:p}=this.props,u=(0,_.getKaid)(e)===a.authorKaid,f="reply"===a.type,m="scratchpad"===a.type,g="projecteval"===a.type,y="projectevalanswer"===a.type;if(!(0,K.isModeratorProfile)(e)&&!u)return[];const h=[],b=(0,K.getPostContext)({profile:e,post:a,moderatorMode:!!n});!(0,K.isModeratorProfile)(e)||f||m||y||g||("comments"!==r&&"clarifications"!==r||h.push(i.createElement(t,{key:"changeToQuestion",onClick:this.handleChangeToQuestion,label:W.postStrings.changeToQuestion})),"questions"!==r&&"clarifications"!==r||h.push(i.createElement(t,{key:"changeToTipsAndThanks",onClick:this.handleChangeToTipsAndThanks,label:W.postStrings.changeToTipsAndThanks})),o||"questions"!==r&&"comments"!==r||h.push(i.createElement(t,{key:"changeToMistakes",onClick:this.handleChangeToMistakes,label:W.postStrings.changeToMistakes})));const w=a.notifyOnAnswer?W.postStrings.turnNotificationsOff:W.postStrings.turnNotificationsOn;return"question"!==a.type||!u&&!(0,K.isModeratorProfile)(e)||a.isOld||h.push(i.createElement(t,{key:"notification",label:w,onClick:()=>{l(a.key,!a.notifyOnAnswer,p)}})),m||g||y||h.push(i.createElement(t,{key:"edit",label:W.postStrings.edit,onClick:()=>this.setState({editing:!0})})),a.deleted||h.push(this.renderDeleteAction(e,t)),(0,K.isModeratorProfile)(e)&&a.deleted&&h.push(i.createElement(t,{key:"undelete",label:W.postStrings.undelete,onClick:()=>s(a)})),K.capabilities.clearFlags(b)&&h.push(i.createElement(t,{key:"clearFlags2",label:W.postStrings.clearFlags,onClick:()=>this.openModal("clearFlags")})),K.capabilities.approve(b)&&h.push(i.createElement(t,{key:"approve",label:W.postStrings.approve,onClick:this.handleClearAllFlags})),n&&(0,K.isModeratorProfile)(e)&&h.push(i.createElement(t,{key:"skip",label:W.postStrings.skip,onClick:this.handleSkip})),!(0,K.isModeratorProfile)(e)||"clarifications"!==r||"Video"!==c&&"video"!==c||h.push(i.createElement(t,{key:"accept_clarification",label:W.postStrings.acceptClarification,onClick:()=>d(a.key)})),h}renderModeratorOrOwnerActionsAsDropdown(e,t){const n=this.getModeratorOrOwnerActions(e,f.ActionItem);return i.createElement(f.ActionMenu,{ref:e=>{const t=s.findDOMNode(e);this.props.getRef&&this.props.getRef(t);const n=t&&t.querySelector("button");n instanceof HTMLButtonElement&&(this.actionMenu=n)},menuText:J._("more"),alignment:"right",style:t},n)}renderModeratorOrOwnerActionsAsFlat(e,t){const n=this.getModeratorOrOwnerActions(e,ae);return i.createElement(u.View,{style:[t,le.expandedActionList]},n.map(((e,t)=>i.createElement(u.View,{key:t},e))))}renderModeratorOrOwnerActions(e,t){const{isMaximized:n}=this.props;return n?this.renderModeratorOrOwnerActionsAsFlat(e,t):this.renderModeratorOrOwnerActionsAsDropdown(e,t)}renderTools(e){const{post:t}=this.props,n="projecteval"===t.type,o="projectevalanswer"===t.type,a=!this.isCompactView()&&!n&&!o;return i.createElement(i.Fragment,null,a&&this.renderVoteTools(e),this.showFlagButton(e)&&this.renderFlagButton(e))}renderVoteTools(e){const{post:t,restrictPosting:n}=this.props,o="reply"===t.type;let a=null;e&&!e.get("isPhantom")&&(e.get("kaid")===t.authorKaid?a="noSelfVoting":e.get("points")<5e3&&!(0,K.isModeratorProfile)(e)&&(a="atLeast5000"));const r=!!a,s=r?y.default.offBlack32:t.upVoted?y.default.green:y.default.offBlack64,l=r?y.default.offBlack32:t.downVoted?y.default.red:y.default.offBlack64,d=t.upVoted?W.postStrings.alreadyUpVoted:void 0,p=t.downVoted?W.postStrings.alreadyDownVoted:void 0;return!o&&!n&&i.createElement(i.Fragment,null,i.createElement(I.default,{content:a&&W.postStrings[a],toggleOnHover:r,offset:12,a11y:{title:{id:"upvote"}}},i.createElement(D.default,{icon:i.createElement(h.default,{"aria-label":d,size:"small",icon:t.upVoted?oe.upvoteSelected:oe.upvote,color:s}),style:le.toolButton,onClick:()=>this.handleUpvote(),disabled:r,"aria-labelledby":"upvote"},i.createElement(u.View,{style:le.voteText},W.postStrings.upvote,!j.default.isLoggedIn&&this.srOnlyToolOpensModal,j.default.isLoggedIn&&a&&i.createElement("span",{className:(0,c.css)(z.default.srOnly)},W.postStrings[a])))),i.createElement(I.default,{content:a&&W.postStrings[a],toggleOnHover:r,offset:12,a11y:{title:{id:"downvote"}}},i.createElement(D.default,{icon:i.createElement(h.default,{"aria-label":p,size:"small",icon:t.downVoted?oe.downvoteSelected:oe.downvote,color:l}),style:le.toolButton,onClick:()=>this.handleDownvote(),disabled:r,"aria-labelledby":"downvote"},i.createElement(u.View,{style:le.voteText},W.postStrings.downvote,!j.default.isLoggedIn&&this.srOnlyToolOpensModal,j.default.isLoggedIn&&a&&i.createElement("span",{className:(0,c.css)(z.default.srOnly)},W.postStrings[a])))),i.createElement(u.View,{style:z.default.srOnly,role:"status","aria-live":"polite"},i.createElement(u.View,null,this.state.ariaVoteMessage),i.createElement(u.View,null,this.state.ariaFlagMessage)))}renderReplies(){const{post:e,tab:t,topicSlug:n,resetNewPostKeyInfo:o,contentId:r,contentKind:s,restrictPosting:l}=this.props,{replies:c,replyCount:d}=e,{repliesExpanded:p}=this.state;if(0===d&&(!j.default.isLoggedIn||l))return;if(p&&d&&d>0&&0===c.length)return i.createElement(u.View,{style:[le.replyContainer,le.loading]},i.createElement(V.default,{size:"xsmall",style:le.spinner,sentryId:"discussion_replies_load",description:"Loading discussion post replies",sentryTeam:"learning-platform"}),W.postStrings.loading);const f=[le.outerRepliesContainer,this.isCompactView()&&se.outerRepliesContainer];return i.createElement(u.View,{style:p?f:[le.collapsedReplyContainer,le.displayNone],id:this.getRepliesContainerId()},i.createElement(u.View,{style:le.innerRepliesContainer},c&&c.map(((e,n)=>i.createElement(u.View,{style:le.replyContainer,key:e},i.createElement(de,(0,a.default)({},this.props,{postKey:e,tab:t,autoFocusPostOnMount:0===n&&p})))))),j.default.isLoggedIn&&!l&&i.createElement(u.View,{style:le.replyInputContainer},i.createElement(P.default,{autoFocus:p&&!c.length,isReply:!0,tab:t,topicSlug:n,feedbackKey:e.key,resetNewPostKeyInfo:o,onPostSuccess:(e,t)=>{},contentKind:s,contentId:r,showAvatar:this.isCompactView()})))}expandAnswers(e){this.setState({expandedKeys:[].concat(this.state.expandedKeys,[e])})}collapseAnswers(e){this.setState({expandedKeys:this.state.expandedKeys.filter((t=>t!==e))})}maybeRenderAnswers(e,t){const{topicSlug:n,newPostKey:o,resetNewPostKeyInfo:a,tab:r,displayInputPostKey:s,restrictPosting:l,clarificationsEnabled:d,viewMode:p,post:u,moderatorMode:f,isMaximized:m,contentKind:g,profile:y}=this.props,h=s===t;if("questions"!==r&&"projecthelp"!==r)return null;if((!e||0===e.length)&&l)return null;const b=i.createElement("div",{className:(0,c.css)(le.answerInputFieldContainer,h&&le.answerInputFieldContainerExpanded),id:(0,K.getAnswerInputId)(t)},"projecthelp"===r&&((0,_.getKaid)(y)===u.authorKaid?W.userProjectsStrings.authorAnsweringOwnHelpRequest:null),i.createElement(P.default,{isAnswer:!0,autoFocus:h,tab:r,clarificationsEnabled:d,onPostSuccess:this.handleAnswerPostSuccess,topicSlug:n,feedbackKey:t,onToggleFormattingOptionsExpanded:e=>this.setState({formattingOptionsExpanded:e}),onTogglePreviewExpanded:e=>this.setState({previewExpanded:e}),showAvatar:!this.isCompactView(),contentKind:g}));if(e&&0!==e.length){const s=this.state.expandedKeys.includes(t)?e:[e[0]];return i.createElement("div",{className:(0,c.css)(le.answersList,"compact"===p&&se.answersList)},!l&&b,i.createElement("ul",null,s.map(((e,t)=>i.createElement("li",{key:e,className:(0,c.css)(le.answer)},i.createElement(de,{tab:r,postKey:e,newPostKey:o,resetNewPostKeyInfo:a,isAnswer:!0,getRef:t=>this.nodes[e]=t,topicSlug:n,restrictPosting:l,moderatorMode:f,viewMode:p,isMaximized:m,autoFocusPostOnMount:1===t}))))),this.maybeRenderExpandCollapseButton(u,t,e,s))}return i.createElement("div",{className:(0,c.css)(le.answersList,this.isCompactView()&&se.answersList,!s&&le.displayNone)},b)}renderDefaultContent(){const{post:e}=this.props,{content:t}=e,n="reply"===e.type;return i.createElement(m.Body,{style:[$.content,n&&le.replyContent]},i.createElement(k.default,{string:t}))}renderProjectEval(){const{post:e}=this.props;return i.createElement(O.default,{post:e})}renderScratchpadContent(){const{post:e}=this.props,{relativeUrl:t="",title:n=""}=e;return i.createElement(u.View,null,i.createElement("h2",null,i.createElement("a",{href:t},n)),i.createElement("iframe",{src:(0,Q.default)(`${t}/embedded?editor=yes`),className:(0,c.css)(le.scratchpadFrame),frameBorder:"0",scrolling:"no"}))}renderProjectPreview(){const{post:e}=this.props,{focus:t}=e;return t&&t.relativeUrl?i.createElement("img",{className:(0,c.css)(le.projectPreview),src:(0,Q.default)(`${t.relativeUrl}/latest.png`),alt:t.translatedTitle}):null}renderContent(){const{post:e}=this.props,{type:t}=e;switch(t){case"scratchpad":return this.renderScratchpadContent();case"projectevalanswer":return this.renderProjectEval();case"projecteval":case"projecthelp":return i.createElement(u.View,null,this.renderDefaultContent(),this.renderProjectPreview());default:return this.renderDefaultContent()}}render(){const{post:e,isAnswer:t,tab:n,contentKind:o,contentId:a,topicSlug:r,resetNewPostKeyInfo:l,clarificationBeingAcceptedId:c,onStopAcceptingClarification:d}=this.props,{key:p,authorNickname:f,authorAvatarName:g,authorAvatarSrc:y,authorKaid:h,content:b,fromVideoAuthor:w}=e,{editing:E,skipped:v}=this.state,x=p===c,O="reply"===e.type;if(v)return null;return i.createElement(u.View,{testId:"discussion-post"},this.renderOpenModals(),!E&&!x&&i.createElement(u.View,{style:[$.post,O&&le.horizontalSeparator],tabIndex:-1,ref:e=>{const t=s.findDOMNode(e);this.props.getRef&&this.props.getRef(t),this.postElement=t}},this.shouldShowAuthor()&&i.createElement(u.View,{style:le.avatar},i.createElement(S.default,{username:f,avatarName:g,avatarSrc:y,kaid:h,enableProfilePreviewTooltip:!0})),i.createElement(u.View,{style:$.everythingButTheAvatar},this.renderPostHeader(),i.createElement(u.View,{style:le.contentContainer},w&&i.createElement(m.LabelSmall,{style:le.fromTheAuthor},W.postStrings.fromTheAuthor),this.renderContent(),(e.appearsAsDeleted||e.deleted)&&i.createElement(u.View,{style:[le.contentBackdrop,e.deleted&&le.deletedPost,e.appearsAsDeleted&&!e.deleted&&le.hiddenPost]})),this.renderPostFooter(),!O&&this.renderReplies())),E&&i.createElement(u.View,{style:le.replyInputContainer},i.createElement(P.default,{editing:E,postKey:e.key,isReply:O,isAnswer:t,tab:n,contentKind:o,contentId:a,topicSlug:r,feedbackKey:e.key,resetNewPostKeyInfo:l,initialPostContent:b,onPostSuccess:(e,t)=>this.handleEditingPost(e),onCancel:()=>this.setState({editing:!1}),showAvatar:!this.isCompactView()}),!O&&i.createElement(u.View,{style:{marginLeft:48}},this.renderReplies())),x&&i.createElement(C.default,{post:e,editingOrAccepting:"accepting",onCancel:d}),!t&&!O&&this.maybeRenderAnswers(e.answers,e.key))}}t.DiscussionPost=re;const ie=y.default.offBlack64,se=c.StyleSheet.create(ee),le=c.StyleSheet.create({postHeader:{flexDirection:"row",justifyContent:"space-between",marginBottom:8},outerRepliesContainer:{backgroundColor:y.default.offWhite,marginTop:b.default.large_24,paddingTop:b.default.large_24,paddingLeft:b.default.large_24,paddingRight:b.default.large_24,maxHeight:"none",transition:`all ${H.standardTransition}`,[U.default.xsOrSmaller]:ee.outerRepliesContainer},outerRepliesContainerWithAvatar:{[U.default.xsOrSmaller]:{marginLeft:-64}},collapsedReplyContainer:{paddingLeft:b.default.large_24,paddingRight:b.default.large_24,maxHeight:0,overflow:"hidden",transition:`all ${H.standardTransition}`,visibility:"hidden"},innerRepliesContainer:{marginBottom:2},replyContainer:{marginBottom:2},replyHeader:{marginBottom:0},replyContent:{paddingTop:b.default.xxxSmall_4},loading:{flexDirection:"row",paddingTop:0,minHeight:48,alignItems:"center"},spinner:{marginRight:b.default.xSmall_8},replyInputContainer:{paddingBottom:b.default.large_24},postedInContainer:{marginTop:b.default.xxxSmall_4,flexDirection:"row",alignItems:"baseline"},postedInLabel:{color:y.default.offBlack64,marginRight:b.default.xxSmall_6},postedInFocusLink:{color:y.default.blue},hiddenPostLabel:{color:y.default.gold,marginLeft:8,alignSelf:"center"},deletedPostLabel:{color:y.default.red,marginLeft:8,alignSelf:"center"},badges:{flexDirection:"row"},badge:{width:16,height:16,marginLeft:4},contentContainer:{position:"relative"},contentBackdrop:{width:"100%",height:"100%",borderRadius:4,opacity:.1,position:"absolute",zIndex:-1},hiddenPost:{backgroundColor:y.default.gold},deletedPost:{backgroundColor:y.default.red},postFooter:{flexDirection:"row",flexWrap:"wrap",alignItems:"center",height:40},postFooterPrimary:{flexDirection:"row",alignItems:"center",width:"100%"},linkStyledButton:{color:ie,border:"none",backgroundColor:"transparent",cursor:"pointer",padding:0,margin:0},votesSum:{color:ie,marginLeft:12,[U.default.xsOrSmaller]:{display:"none"}},voteText:{[U.default.xsOrSmaller]:{display:"none"}},toolButton:{marginLeft:12},flagTool:{[U.default.xsOrSmaller]:{}},flagText:{[U.default.xsOrSmaller]:ee.flagText},moderatorFlagged:{marginLeft:8},fromTheAuthor:{marginLeft:8},notificationsUnavailableText:{marginLeft:12},horizontalSeparator:{borderBottom:$.border,clear:"both",paddingBottom:b.default.small_12,":last-child":{borderBottom:"none",paddingBottom:0}},separator:{color:$.borderColor,paddingLeft:b.default.xxxSmall_4,paddingRight:b.default.xxxSmall_4},expandCollapseButton:{marginTop:24,marginBottom:8},answersList:{marginLeft:68,[U.default.xsOrSmaller]:ee.answersList},answerInputFieldContainer:{display:"none"},answerInputFieldContainerExpanded:{margin:"20px 0 28px 0",display:"block"},maximizedDesktop:{[U.default.smOrSmaller]:{display:"none"}},displayNone:{display:"none"},answer:{marginTop:24},expandedActionList:{flexDirection:"row"},avatar:{marginRight:24},scratchpadFrame:{width:940,height:440,border:0},flagsTooltipRow:{flexDirection:"row"},flagsTooltipKaid:{color:y.default.blue},flagsTooltipText:{paddingLeft:8},projectPreview:{width:40}}),ce={onChangeType:X.changeType,onClearFlags:X.clearFlags,onDeletePost:X.deletePost,onDownvotePost:X.downvotePost,onFlagPost:X.flagPost,onModifyNotifications:X.modifyNotificationsAction,onPostSuccess:X.postSuccessAction,onShowReplies:X.fetchReplies,onToggleReplyInput:X.toggleReplyInputAction,onUndeletePost:X.undeletePost,onUpvotePost:X.upvotePost,resetExpandKey:X.resetExpandKeyAction,onStartAcceptingClarification:X.startAcceptingClarificationAction,onStopAcceptingClarification:X.stopAcceptingClarificationAction},de=(0,p.compose)(N.default,B.default,E.withActionScheduler,q.default,(0,l.connect)(((e,t)=>{const n=e.posts[t.postKey],{contentKind:o,contentId:a}=((e,t,n,o)=>{if(n.focus)return{contentKind:n.focus.kind,contentId:n.focus.id};if(n.question&&n.question.focus)return{contentKind:n.question.focus.kind,contentId:n.question.focus.id};if(n.questionKey){const t=e[n.questionKey];if(t&&t.focus)return{contentKind:t.focus.kind,contentId:t.focus.id}}else if(o)return{contentKind:o.contentKind,contentId:o.contentId};return t})(e.posts,{contentKind:e.contentKind,contentId:e.contentId},n,t.contentKind?{contentKind:t.contentKind,contentId:t.contentId}:void 0),r="Topic"===e.contentKind,i=r&&"answer"===n.type;return{post:n,contentId:a,contentKind:o,qaExpandKey:e.qaExpandKey,newPostKey:e.newPostKey,displayInputPostKey:e.displayInputPostKey,clarificationBeingAcceptedId:e.clarificationBeingAcceptedId,showPostedIn:r,showParentQuestion:i}}),ce))(re);var pe=de;t.default=pe}}]);
//# sourceMappingURL=../../sourcemaps/en/2rZ3.d5c01442aace3c066a5e.js.map