(window.webpackJsonp=window.webpackJsonp||[]).push([["4jaK"],{B4xi:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UPDATE_TASK_STATUS=t.UPDATE_STATUS=t.UPDATE_RECOMMENDATIONS=t.UPDATE_QUIZ_SCORE=t.UPDATE_PROGRESS=t.UPDATE_LATEST_SCORE=t.UPDATE_LAST_SECOND_WATCHED=t.UPDATE_FPM_MASTERY_COMPLETE=t.UPDATE_FPM_MASTERY=t.UPDATE_BEST_SCORE=t.SET_CURRENT_TOPIC=t.LOAD_USER_INFO=t.CLEAR_RECOMMENDATIONS=t.CLEAR_RECOMMENDATION=void 0;t.SET_CURRENT_TOPIC="SET_CURRENT_TOPIC";t.CLEAR_RECOMMENDATION="CLEAR_RECOMMENDATION";t.CLEAR_RECOMMENDATIONS="CLEAR_RECOMMENDATIONS";t.LOAD_USER_INFO="LOAD_USER_INFO";t.UPDATE_FPM_MASTERY="UPDATE_FPM_MASTERY";t.UPDATE_FPM_MASTERY_COMPLETE="UPDATE_FPM_MASTERY_COMPLETE";t.UPDATE_PROGRESS="UPDATE_PROGRESS";t.UPDATE_RECOMMENDATIONS="UPDATE_RECOMMENDATIONS";t.UPDATE_STATUS="UPDATE_STATUS";t.UPDATE_BEST_SCORE="UPDATE_BEST_SCORE";t.UPDATE_LATEST_SCORE="UPDATE_LATEST_SCORE";t.UPDATE_QUIZ_SCORE="UPDATE_QUIZ_SCORE";t.UPDATE_TASK_STATUS="UPDATE_TASK_STATUS";t.UPDATE_LAST_SECOND_WATCHED="UPDATE_LAST_SECOND_WATCHED"},"FQT/":function(e,t,r){"use strict";var a=r("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.furthestProgress=n,t.mergeStatusMaps=function(e,t){const r={};for(const a of Object.keys((0,s.default)({},e,t)))r[a]=n(e[a],t[a]);return r};var s=a(r("pVnL"));function n(e,t){return t=t||"unstarted",o[e=e||"unstarted"]>o[t]?e:t}const o={unstarted:0,started:1,complete:2}},Jayu:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r("ANjH"),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=o(t);if(r&&r.has(e))return r.get(e);var a={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&Object.prototype.hasOwnProperty.call(e,n)){var u=s?Object.getOwnPropertyDescriptor(e,n):null;u&&(u.get||u.set)?Object.defineProperty(a,n,u):a[n]=e[n]}a.default=e,r&&r.set(e,a);return a}(r("kDsU")),n=r("e5gs");function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(o=function(e){return e?r:t})(e)}const u=(0,r("0zMT").createCompose)({reduxDevtoolsOptions:{name:"User Info"}}),c=(0,n.handleSideEffects)(n.defaultCallbacks);var i=(0,a.createStore)(s.default,s.defaultState,u((0,a.applyMiddleware)((e=>t=>r=>{const a=t(r);return c(t,r,e.getState()),a}))));t.default=i},e5gs:function(e,t,r){"use strict";var a=r("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.handleSideEffects=t.defaultCallbacks=void 0;var s=a(r("pVnL")),n=a(r("lTCR")),o=r("8r+/"),u=r("z39W"),c=a(r("mXPZ")),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=d(t);if(r&&r.has(e))return r.get(e);var a={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&Object.prototype.hasOwnProperty.call(e,n)){var o=s?Object.getOwnPropertyDescriptor(e,n):null;o&&(o.get||o.set)?Object.defineProperty(a,n,o):a[n]=e[n]}a.default=e,r&&r.set(e,a);return a}(r("B4xi")),p=r("pCog");let l;function d(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(d=function(e){return e?r:t})(e)}t.handleSideEffects=e=>(t,r,a)=>{switch(r.type){case i.SET_CURRENT_TOPIC:e.onSetCurrentTopic&&e.onSetCurrentTopic(t,r.topicId,r.masteryEnabled)}};const E=(0,o.gqlOp)((0,n.default)(l||(l=(e=>e)`
    query getFpmMasteryForTopic($topicId: String!) {
        user {
            id
            curationItemProgress(topicId: $topicId) {
                masteryMap {
                    progressKey
                    status
                }
                currentMastery {
                    percentage
                    pointsEarned
                    pointsAvailable
                }
            }
        }
    }
`))),T={onSetCurrentTopic:(e,t,r)=>{r&&c.default.hasProfile&&(0,u.getUnsafeGqlClient)().query(E,{variables:{topicId:t},fetchPolicy:"network-only"}).then((({data:t})=>{const{curationItemProgress:r}=(null==t?void 0:t.user)||{},a={masteryMap:r.masteryMap.reduce(((e,{progressKey:t,status:r})=>(0,s.default)({},e,{[t]:r})),{}),masteryPercentage:r.currentMastery.percentage,masteryPointsEarned:r.currentMastery.pointsEarned,masteryPointsAvailable:r.currentMastery.pointsAvailable};e((0,p.updateFpmMastery)(a))})).then((()=>{e((0,p.updateFpmMasteryComplete)())}))}};t.defaultCallbacks=T},kDsU:function(e,t,r){"use strict";var a=r("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.defaultState=t.default=void 0;var s=a(r("pVnL")),n=r("B4xi"),o=r("nA/X"),u=r("FQT/");function c(e,t,r){return{percentage:e,pointsEarned:t,pointsAvailable:r}}const i={currentTopic:null,bestScoreMap:{},latestScoreMap:{},masteryMap:{},unitMastery:{percentage:0,pointsEarned:0,pointsAvailable:0},subjectMastery:{percentage:0,pointsEarned:0,pointsAvailable:0},masteryUpdateComplete:!1,quizScores:{},recommendations:[],statusMap:{},taskInProgressMap:{},lastSecondWatchedMap:{}};t.defaultState=i;var p=(e,t)=>{if(!e)return i;switch(t.type){case n.UPDATE_PROGRESS:{const r=t.fpmPromotions||{},a=(0,o.getUpdatedMasteryPoints)(e.unitMastery,e.masteryMap,r),n=(0,o.getUpdatedMasteryPoints)(e.subjectMastery,e.masteryMap,r),u=(0,s.default)({},e.masteryMap);return Object.keys(e.masteryMap).forEach((e=>{u[e]=r[e]||u[e]})),(0,s.default)({},e,{masteryMap:u,subjectMastery:n,unitMastery:a})}case n.SET_CURRENT_TOPIC:return(0,s.default)({},e,{currentTopic:t.topicId});case n.UPDATE_FPM_MASTERY_COMPLETE:return(0,s.default)({},e,{masteryUpdateComplete:!0});case n.UPDATE_FPM_MASTERY:return(0,s.default)({},e,{masteryMap:t.masteryMap,unitMastery:"number"==typeof t.masteryPercentage?c(t.masteryPercentage,t.masteryPointsEarned||0,t.masteryPointsAvailable||0):e.unitMastery});case n.UPDATE_STATUS:{const r=e.statusMap[t.progressKey],a=(0,u.furthestProgress)(r,t.status);return a===r?e:(0,s.default)({},e,{statusMap:(0,s.default)({},e.statusMap,{[t.progressKey]:a})})}case n.UPDATE_TASK_STATUS:return(0,s.default)({},e,{taskInProgressMap:(0,s.default)({},e.taskInProgressMap,{[t.taskKey]:t.inProgress})});case n.UPDATE_BEST_SCORE:{let{bestScore:r}=t;const a=r.numCorrect/r.numAttempted,n=e.bestScoreMap[t.progressKey];return n&&n.numCorrect/n.numAttempted>=a&&(r=n),(0,s.default)({},e,{bestScoreMap:(0,s.default)({},e.bestScoreMap,{[t.progressKey]:r})})}case n.UPDATE_LATEST_SCORE:{const{latestScore:r}=t;return(0,s.default)({},e,{latestScoreMap:(0,s.default)({},e.latestScoreMap,{[t.progressKey]:r})})}case n.UPDATE_QUIZ_SCORE:return(0,s.default)({},e,{quizScores:(0,s.default)({},e.quizScores,{[t.quizKey]:t.quizScore})});case n.UPDATE_RECOMMENDATIONS:return(0,s.default)({},e,{recommendations:t.recommendations});case n.CLEAR_RECOMMENDATION:{const r=t;return(0,s.default)({},e,{recommendations:e.recommendations.filter((({contentId:e,kind:t})=>t!==r.kind||e!==r.contentId))})}case n.CLEAR_RECOMMENDATIONS:{const r=t;return(0,s.default)({},e,{recommendations:e.recommendations.filter((({sourceId:e})=>e!==r.sourceId))})}case n.LOAD_USER_INFO:const r=t.userInfo.masteryMap||e.masteryMap;return(0,s.default)({},e,{masteryMap:r,unitMastery:c(null!=t.userInfo.masteryPercentage?t.userInfo.masteryPercentage:e.unitMastery.percentage,null!=t.userInfo.masteryPointsEarned?t.userInfo.masteryPointsEarned:e.unitMastery.pointsEarned,null!=t.userInfo.masteryPointsAvailable?t.userInfo.masteryPointsAvailable:e.unitMastery.pointsAvailable),subjectMastery:null!=t.userInfo.subjectMasteryPercentage&&null!=t.userInfo.subjectMasteryPointsEarned&&null!=t.userInfo.subjectMasteryPointsAvailable?c(t.userInfo.subjectMasteryPercentage,t.userInfo.subjectMasteryPointsEarned,t.userInfo.subjectMasteryPointsAvailable):e.subjectMastery,quizScores:(0,s.default)({},t.userInfo.quizScores,e.quizScores),recommendations:t.userInfo.recommendations||e.recommendations,statusMap:(0,u.mergeStatusMaps)(t.userInfo.statusMap||{},e.statusMap),taskInProgressMap:(0,s.default)({},t.userInfo.taskInProgressMap,e.taskInProgressMap),bestScoreMap:(0,s.default)({},t.userInfo.bestScoreMap,e.bestScoreMap),latestScoreMap:(0,s.default)({},t.userInfo.latestScoreMap,e.latestScoreMap)});case n.UPDATE_LAST_SECOND_WATCHED:return void 0===t.lastSecondWatched||t.lastSecondWatched===e.lastSecondWatchedMap[t.readableId]?e:(0,s.default)({},e,{lastSecondWatchedMap:(0,s.default)({},e.lastSecondWatchedMap,{[t.readableId]:t.lastSecondWatched})});default:return e}};t.default=p},pCog:function(e,t,r){"use strict";var a=r("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.updateRecommendations=t.updateProgress=t.updateFpmMasteryComplete=t.updateFpmMastery=t.startQuiz=t.setCurrentTopic=t.retryQuiz=t.reportQuizCompletion=t.clearForTopic=t.clearForItem=void 0;var s=a(r("lTCR")),n=r("skGw"),o=r("B4xi"),u=r("z39W"),c=r("8r+/"),i=r("ZC1Y");let p;t.setCurrentTopic=(e,t)=>({type:o.SET_CURRENT_TOPIC,topicId:e,masteryEnabled:t});t.clearForTopic=(e,t)=>{const r=(0,n.encodeParams)({topicId:e,sourceId:t});return(0,n.khanFetch)(`/api/internal/user/recommendations/clear_for_source?${r}`,{method:"POST"}),{type:o.CLEAR_RECOMMENDATIONS,sourceId:t}};const l=(0,c.gqlOp)((0,s.default)(p||(p=(e=>e)`
    mutation clearRecommendationForContentItemWeb(
        $contentDescriptor: String!
        $unitId: String!
    ) {
        clearRecommendation(
            contentDescriptor: $contentDescriptor
            unitId: $unitId
        ) {
            wasSuccessful
        }
    }
`)));t.clearForItem=(e,t)=>((0,u.getUnsafeGqlClient)().mutate(l,{variables:{unitId:t,contentDescriptor:(0,i.getContentDescriptor)(e)}}),{type:o.CLEAR_RECOMMENDATION,contentId:e.contentId,kind:e.kind});t.retryQuiz=e=>({type:o.UPDATE_TASK_STATUS,taskKey:e,inProgress:!1});t.startQuiz=e=>({type:o.UPDATE_TASK_STATUS,taskKey:e,inProgress:!0});t.reportQuizCompletion=(e,t)=>({type:o.UPDATE_QUIZ_SCORE,quizKey:e,quizScore:{completedDate:new Date,numCorrect:t.filter((e=>e.correct)).length,numAttempted:t.length}});t.updateFpmMastery=({masteryMap:e,masteryPercentage:t,masteryPointsEarned:r,masteryPointsAvailable:a})=>({type:o.UPDATE_FPM_MASTERY,masteryMap:e,masteryPercentage:t,masteryPointsEarned:r,masteryPointsAvailable:a});t.updateFpmMasteryComplete=()=>({type:o.UPDATE_FPM_MASTERY_COMPLETE});t.updateProgress=e=>({type:o.UPDATE_PROGRESS,fpmPromotions:e});t.updateRecommendations=e=>({type:o.UPDATE_RECOMMENDATIONS,recommendations:e})}}]);
//# sourceMappingURL=../../sourcemaps/en/4jaK.7534dbabcbe6f3d6cdd4.js.map